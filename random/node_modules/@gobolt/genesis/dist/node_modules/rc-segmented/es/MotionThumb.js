import V from "../../@babel/runtime/helpers/esm/objectSpread2.js";
import c from "../../@babel/runtime/helpers/esm/slicedToArray.js";
import j from "../../../_virtual/index.js";
import q from "../../rc-motion/es/CSSMotion.js";
import "../../rc-motion/es/CSSMotionList.js";
import * as u from "react";
import D from "../../rc-util/es/hooks/useLayoutEffect.js";
import { composeRef as I } from "../../rc-util/es/ref.js";
var H = function(t, v) {
  if (!t) return null;
  var r = { left: t.offsetLeft, right: t.parentElement.clientWidth - t.clientWidth - t.offsetLeft, width: t.clientWidth, top: t.offsetTop, bottom: t.parentElement.clientHeight - t.clientHeight - t.offsetTop, height: t.clientHeight };
  return v ? { left: 0, right: 0, width: 0, top: r.top, bottom: r.bottom, height: r.height } : { left: r.left, right: r.right, width: r.width, top: 0, bottom: 0, height: 0 };
}, h = function(t) {
  return t !== void 0 ? "".concat(t, "px") : void 0;
};
function K(t) {
  var v = t.prefixCls, r = t.containerRef, m = t.value, C = t.getValueIndex, L = t.motionName, R = t.onMotionStart, d = t.onMotionEnd, s = t.direction, p = t.vertical, n = p !== void 0 && p, W = u.useRef(null), X = u.useState(m), b = c(X, 2), g = b[0], O = b[1], w = function(e) {
    var l, f = C(e), a = (l = r.current) === null || l === void 0 ? void 0 : l.querySelectorAll(".".concat(v, "-item"))[f];
    return (a == null ? void 0 : a.offsetParent) && a;
  }, P = u.useState(null), E = c(P, 2), i = E[0], S = E[1], Y = u.useState(null), N = c(Y, 2), o = N[0], y = N[1];
  D(function() {
    if (g !== m) {
      var e = w(g), l = w(m), f = H(e, n), a = H(l, n);
      O(m), S(f), y(a), e && l ? R() : d();
    }
  }, [m]);
  var A = u.useMemo(function() {
    var e;
    return h(n ? (e = i == null ? void 0 : i.top) !== null && e !== void 0 ? e : 0 : s === "rtl" ? -(i == null ? void 0 : i.right) : i == null ? void 0 : i.left);
  }, [n, s, i]), M = u.useMemo(function() {
    var e;
    return h(n ? (e = o == null ? void 0 : o.top) !== null && e !== void 0 ? e : 0 : s === "rtl" ? -(o == null ? void 0 : o.right) : o == null ? void 0 : o.left);
  }, [n, s, o]);
  return i && o ? u.createElement(q, { visible: !0, motionName: L, motionAppear: !0, onAppearStart: function() {
    return n ? { transform: "translateY(var(--thumb-start-top))", height: "var(--thumb-start-height)" } : { transform: "translateX(var(--thumb-start-left))", width: "var(--thumb-start-width)" };
  }, onAppearActive: function() {
    return n ? { transform: "translateY(var(--thumb-active-top))", height: "var(--thumb-active-height)" } : { transform: "translateX(var(--thumb-active-left))", width: "var(--thumb-active-width)" };
  }, onVisibleChanged: function() {
    S(null), y(null), d();
  } }, function(e, l) {
    var f = e.className, a = e.style, x = V(V({}, a), {}, { "--thumb-start-left": A, "--thumb-start-width": h(i == null ? void 0 : i.width), "--thumb-active-left": M, "--thumb-active-width": h(o == null ? void 0 : o.width), "--thumb-start-top": A, "--thumb-start-height": h(i == null ? void 0 : i.height), "--thumb-active-top": M, "--thumb-active-height": h(o == null ? void 0 : o.height) }), T = { ref: I(W, l), style: x, className: j("".concat(v, "-thumb"), f) };
    return process.env.NODE_ENV === "test" && (T["data-test-style"] = JSON.stringify(x)), u.createElement("div", T);
  }) : null;
}
export {
  K as default
};

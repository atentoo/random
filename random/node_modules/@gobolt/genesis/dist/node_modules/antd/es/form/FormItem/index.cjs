"use strict";const g=require("../../../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),ge=require("react"),me=require("../../../../../_virtual/index.cjs");require("../../../../rc-field-form/es/index.cjs");const fe=require("../../../../rc-util/es/hooks/useState.cjs"),he=require("../../../../rc-util/es/ref.cjs"),ye=require("../../_util/reactNode.cjs"),ve=require("../../_util/warning.cjs");require("../../config-provider/index.cjs");const be=require("../../config-provider/hooks/useCSSVarCls.cjs"),ee=require("../context.cjs"),qe=require("../hooks/useChildren.cjs"),Oe=require("../hooks/useFormItemStatus.cjs"),Ee=require("../hooks/useFrameState.cjs"),Ne=require("../hooks/useItemRef.cjs"),we=require("../style/index.cjs"),V=require("../util.cjs"),je=require("./ItemHolder.cjs"),xe=require("./StatusProvider.cjs"),Ce=require("../../config-provider/context.cjs"),_e=require("../../../../rc-field-form/es/FieldContext.cjs"),Ve=require("../../../../rc-field-form/es/ListContext.cjs"),Se=require("../../../../rc-field-form/es/Field.cjs");function Fe(e){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const a in e)if(a!=="default"){const l=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(n,a,l.get?l:{enumerable:!0,get:()=>e[a]})}}return n.default=e,Object.freeze(n)}const u=Fe(ge),Ie=u.memo(e=>{let{children:n}=e;return n},(e,n)=>function(a,l){const c=Object.keys(a),S=Object.keys(l);return c.length===S.length&&c.every(f=>{const q=a[f],w=l[f];return q===w||typeof q=="function"||typeof w=="function"})}(e.control,n.control)&&e.update===n.update&&e.childProps.length===n.childProps.length&&e.childProps.every((a,l)=>a===n.childProps[l])),te=function(e){const{name:n,noStyle:a,className:l,dependencies:c,prefixCls:S,shouldUpdate:f,rules:q,children:w,required:k,label:M,messageVariables:T,trigger:R="onChange",validateTrigger:U,hidden:re,help:F,layout:ne}=e,{getPrefixCls:oe}=u.useContext(Ce.ConfigContext),{name:se}=u.useContext(ee.FormContext),s=qe(w),j=typeof s=="function",L=u.useContext(ee.NoStyleItemContext),{validateTrigger:ae}=u.useContext(_e.default),$=U!==void 0?U:ae,y=n!=null,x=oe("form",S),z=be(x),[K,ie,ue]=we.default(x,z),m=ve.devUseWarning("Form.Item");process.env.NODE_ENV!=="production"&&process.env.NODE_ENV!=="production"&&m(n!==null,"usage","`null` is passed as `name` property");const W=u.useContext(Ve),Y=u.useRef(null),[B,le]=Ee({}),[v,ce]=fe(()=>({errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1})),de=(t,i)=>{le(o=>{const d=Object.assign({},o),p=[].concat(g(t.name.slice(0,-1)),g(i)).join("__SPLIT__");return t.destroy?delete d[p]:d[p]=t,d})},[O,I]=u.useMemo(()=>{const t=g(v.errors),i=g(v.warnings);return Object.values(B).forEach(o=>{t.push.apply(t,g(o.errors||[])),i.push.apply(i,g(o.warnings||[]))}),[t,i]},[B,v.errors,v.warnings]),pe=Ne();function G(t,i,o){return a&&!re?u.createElement(xe,{prefixCls:x,hasFeedback:e.hasFeedback,validateStatus:e.validateStatus,meta:v,errors:O,warnings:I,noStyle:!0},t):u.createElement(je,Object.assign({key:"row"},e,{className:me(l,ue,z,ie),prefixCls:x,fieldId:i,isRequired:o,errors:O,warnings:I,meta:v,onSubItemMetaChange:de,layout:ne}),t)}if(!y&&!j&&!c)return K(G(s));let E={};return typeof M=="string"?E.label=M:n&&(E.label=String(n)),T&&(E=Object.assign(Object.assign({},E),T)),K(u.createElement(Se,Object.assign({},e,{messageVariables:E,trigger:R,validateTrigger:$,onMetaChange:t=>{const i=W==null?void 0:W.getKey(t.name);if(ce(t.destroy?{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}:t,!0),a&&F!==!1&&L){let o=t.name;if(t.destroy)o=Y.current||o;else if(i!==void 0){const[d,p]=i;o=[d].concat(g(p)),Y.current=o}L(t,o)}}}),(t,i,o)=>{const d=V.toArray(n).length&&i?i.name:[],p=V.getFieldId(d,se),H=k!==void 0?k:!!(q!=null&&q.some(r=>{if(r&&typeof r=="object"&&r.required&&!r.warningOnly)return!0;if(typeof r=="function"){const b=r(o);return(b==null?void 0:b.required)&&!(b!=null&&b.warningOnly)}return!1})),C=Object.assign({},t);let N=null;if(process.env.NODE_ENV!=="production"&&m(!(f&&c),"usage","`shouldUpdate` and `dependencies` shouldn't be used together. See https://u.ant.design/form-deps."),Array.isArray(s)&&y)process.env.NODE_ENV!=="production"&&m(!1,"usage","A `Form.Item` with a `name` prop must have a single child element. For information on how to render more complex form items, see https://u.ant.design/complex-form-item."),N=s;else if(j&&(!f&&!c||y))process.env.NODE_ENV!=="production"&&m(!(!f&&!c),"usage","A `Form.Item` with a render function must have either `shouldUpdate` or `dependencies`."),process.env.NODE_ENV!=="production"&&m(!y,"usage","A `Form.Item` with a render function cannot be a field, and thus cannot have a `name` prop.");else if(!c||j||y)if(u.isValidElement(s)){process.env.NODE_ENV!=="production"&&m(s.props.defaultValue===void 0,"usage","`defaultValue` will not work on controlled Field. You should use `initialValues` of Form instead.");const r=Object.assign(Object.assign({},s.props),C);if(r.id||(r.id=p),F||O.length>0||I.length>0||e.extra){const h=[];(F||O.length>0)&&h.push(`${p}_help`),e.extra&&h.push(`${p}_extra`),r["aria-describedby"]=h.join(" ")}O.length>0&&(r["aria-invalid"]="true"),H&&(r["aria-required"]="true"),he.supportRef(s)&&(r.ref=pe(d,s)),new Set([].concat(g(V.toArray(R)),g(V.toArray($)))).forEach(h=>{r[h]=function(){for(var J,Q,D,X,A,Z=arguments.length,P=new Array(Z),_=0;_<Z;_++)P[_]=arguments[_];(D=C[h])===null||D===void 0||(J=D).call.apply(J,[C].concat(P)),(A=(X=s.props)[h])===null||A===void 0||(Q=A).call.apply(Q,[X].concat(P))}});const b=[r["aria-required"],r["aria-invalid"],r["aria-describedby"]];N=u.createElement(Ie,{control:C,update:s,childProps:b},ye.cloneElement(s,r))}else j&&(f||c)&&!y?N=s(o):(process.env.NODE_ENV!=="production"&&m(!d.length||!!a,"usage","`name` is only used for validate React element. If you are using Form.Item as layout display, please remove `name` instead."),N=s);else process.env.NODE_ENV!=="production"&&m(!1,"usage","Must set `name` or use a render function when `dependencies` is set.");return G(N,p,H)}))};te.useStatus=Oe,module.exports=te;

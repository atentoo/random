"use strict";const Q=require("../../../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),X=require("react"),Y=require("../../../../../_virtual/index.cjs"),F=require("../../../../rc-util/es/hooks/useEvent.cjs"),Z=require("../../../../rc-util/es/pickAttrs.cjs"),ee=require("../../_util/statusUtils.cjs"),te=require("../../_util/warning.cjs");require("../../config-provider/index.cjs");const re=require("../../config-provider/hooks/useSize.cjs"),N=require("../../form/context.cjs"),ne=require("../style/otp.cjs"),ae=require("./OTPInput.cjs"),oe=require("../../config-provider/context.cjs");function se(a){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(a){for(const u in a)if(u!=="default"){const r=Object.getOwnPropertyDescriptor(a,u);Object.defineProperty(i,u,r.get?r:{enumerable:!0,get:()=>a[u]})}}return i.default=a,Object.freeze(i)}const s=se(X);var ue=function(a,i){var u={};for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&i.indexOf(r)<0&&(u[r]=a[r]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(r=Object.getOwnPropertySymbols(a);l<r.length;l++)i.indexOf(r[l])<0&&Object.prototype.propertyIsEnumerable.call(a,r[l])&&(u[r[l]]=a[r[l]])}return u};function d(a){return(a||"").split("")}const le=a=>{const{index:i,prefixCls:u,separator:r}=a,l=typeof r=="function"?r(i):r;return l?s.createElement("span",{className:`${u}-separator`},l):null},ie=s.forwardRef((a,i)=>{const{prefixCls:u,length:r=6,size:l,defaultValue:P,value:m,onChange:y,formatter:C,separator:S,variant:k,disabled:M,status:$,autoFocus:w,mask:g,type:z,onInput:x,inputMode:_}=a,A=ue(a,["prefixCls","length","size","defaultValue","value","onChange","formatter","separator","variant","disabled","status","autoFocus","mask","type","onInput","inputMode"]);if(process.env.NODE_ENV!=="production"){const e=te.devUseWarning("Input.OTP");process.env.NODE_ENV!=="production"&&e(!(typeof g=="string"&&g.length>1),"usage","`mask` prop should be a single character.")}const{getPrefixCls:D,direction:V}=s.useContext(oe.ConfigContext),c=D("otp",u),R=Z(A,{aria:!0,data:!0,attr:!0}),[T,H,U]=ne(c),v=re(e=>l??e),b=s.useContext(N.FormItemInputContext),h=ee.getMergedStatus(b.status,$),W=s.useMemo(()=>Object.assign(Object.assign({},b),{status:h,hasFeedback:!1,feedbackIcon:null}),[b,h]),j=s.useRef(null),f=s.useRef({});s.useImperativeHandle(i,()=>({focus:()=>{var e;(e=f.current[0])===null||e===void 0||e.focus()},blur:()=>{var e;for(let t=0;t<r;t+=1)(e=f.current[t])===null||e===void 0||e.blur()},nativeElement:j.current}));const q=e=>C?C(e):e,[O,E]=s.useState(()=>d(q(P||"")));s.useEffect(()=>{m!==void 0&&E(d(m))},[m]);const B=F(e=>{E(e),x&&x(e),y&&e.length===r&&e.every(t=>t)&&e.some((t,n)=>O[n]!==t)&&y(e.join(""))}),G=F((e,t)=>{let n=Q(O);for(let o=0;o<e;o+=1)n[o]||(n[o]="");t.length<=1?n[e]=t:n=n.slice(0,e).concat(d(t)),n=n.slice(0,r);for(let o=n.length-1;o>=0&&!n[o];o-=1)n.pop();const p=q(n.map(o=>o||" ").join(""));return n=d(p).map((o,I)=>o!==" "||n[I]?o:n[I]),n}),J=(e,t)=>{var n;const p=G(e,t),o=Math.min(e+t.length,r-1);o!==e&&p[e]!==void 0&&((n=f.current[o])===null||n===void 0||n.focus()),B(p)},K=e=>{var t;(t=f.current[e])===null||t===void 0||t.focus()},L={variant:k,disabled:M,status:h,mask:g,type:z,inputMode:_};return T(s.createElement("div",Object.assign({},R,{ref:j,className:Y(c,{[`${c}-sm`]:v==="small",[`${c}-lg`]:v==="large",[`${c}-rtl`]:V==="rtl"},U,H)}),s.createElement(N.FormItemInputContext.Provider,{value:W},Array.from({length:r}).map((e,t)=>{const n=`otp-${t}`,p=O[t]||"";return s.createElement(s.Fragment,{key:n},s.createElement(ae,Object.assign({ref:o=>{f.current[t]=o},index:t,size:v,htmlSize:1,className:`${c}-input`,onChange:J,value:p,onActiveChange:K,autoFocus:t===0&&w},L)),t<r-1&&s.createElement(le,{separator:S,index:t,prefixCls:c}))}))))});module.exports=ie;

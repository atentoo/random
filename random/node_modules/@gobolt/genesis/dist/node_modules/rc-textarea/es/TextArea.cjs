"use strict";const he=require("../../@babel/runtime/helpers/esm/extends.cjs"),X=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),i=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),Ce=require("../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),m=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),pe=require("../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),x=require("../../../_virtual/index.cjs"),ye=require("../../rc-input/es/BaseInput.cjs"),Ee=require("../../rc-util/es/hooks/useMergedState.cjs"),t=require("react"),we=require("../../rc-input/es/hooks/useCount.cjs"),Y=require("../../rc-input/es/utils/commonUtils.cjs"),qe=require("./ResizableTextArea.cjs");var ve=["defaultValue","value","onFocus","onBlur","onChange","allowClear","maxLength","onCompositionStart","onCompositionEnd","suffix","prefixCls","showCount","count","className","style","disabled","hidden","classNames","styles","onResize","onClear","onPressEnter","readOnly","autoSize","onKeyDown"],Se=t.forwardRef(function(n,Z){var g,R=n.defaultValue,_=n.value,b=n.onFocus,F=n.onBlur,O=n.onChange,h=n.allowClear,A=n.maxLength,L=n.onCompositionStart,T=n.onCompositionEnd,$=n.suffix,B=n.prefixCls,u=B===void 0?"rc-textarea":B,C=n.showCount,ee=n.count,ne=n.className,p=n.style,c=n.disabled,te=n.hidden,l=n.classNames,f=n.styles,D=n.onResize,re=n.onClear,K=n.onPressEnter,V=n.readOnly,W=n.autoSize,P=n.onKeyDown,ae=pe(n,ve),oe=Ee(R,{value:_,defaultValue:R}),k=m(oe,2),H=k[0],I=k[1],y=H==null?"":String(H),le=t.useState(!1),j=m(le,2),ue=j[0],E=j[1],w=t.useRef(!1),ie=t.useState(null),G=m(ie,2),se=G[0],ce=G[1],J=t.useRef(null),q=t.useRef(null),a=function(){var e;return(e=q.current)===null||e===void 0?void 0:e.textArea},M=function(){a().focus()};t.useImperativeHandle(Z,function(){var e;return{resizableTextArea:q.current,focus:M,blur:function(){a().blur()},nativeElement:((e=J.current)===null||e===void 0?void 0:e.nativeElement)||a()}}),t.useEffect(function(){E(function(e){return!c&&e})},[c]);var fe=t.useState(null),Q=m(fe,2),v=Q[0],de=Q[1];t.useEffect(function(){var e;v&&(e=a()).setSelectionRange.apply(e,Ce(v))},[v]);var d,r=we(ee,C),s=(g=r.max)!==null&&g!==void 0?g:A,me=Number(s)>0,S=r.strategy(y),xe=!!s&&S>s,U=function(e,o){var N=o;!w.current&&r.exceedFormatter&&r.max&&r.strategy(o)>r.max&&o!==(N=r.exceedFormatter(o,{max:r.max}))&&de([a().selectionStart||0,a().selectionEnd||0]),I(N),Y.resolveOnChange(e.currentTarget,e,O,N)},z=$;r.show&&(d=r.showFormatter?r.showFormatter({value:y,count:S,maxLength:s}):"".concat(S).concat(me?" / ".concat(s):""),z=t.createElement(t.Fragment,null,z,t.createElement("span",{className:x("".concat(u,"-data-count"),l==null?void 0:l.count),style:f==null?void 0:f.count},d)));var ge=!W&&!C&&!h;return t.createElement(ye,{ref:J,value:y,allowClear:h,handleReset:function(e){I(""),M(),Y.resolveOnChange(a(),e,O)},suffix:z,prefixCls:u,classNames:i(i({},l),{},{affixWrapper:x(l==null?void 0:l.affixWrapper,X(X({},"".concat(u,"-show-count"),C),"".concat(u,"-textarea-allow-clear"),h))}),disabled:c,focused:ue,className:x(ne,xe&&"".concat(u,"-out-of-range")),style:i(i({},p),se&&!ge?{height:"auto"}:{}),dataAttrs:{affixWrapper:{"data-count":typeof d=="string"?d:void 0}},hidden:te,readOnly:V,onClear:re},t.createElement(qe,he({},ae,{autoSize:W,maxLength:A,onKeyDown:function(e){e.key==="Enter"&&K&&K(e),P==null||P(e)},onChange:function(e){U(e,e.target.value)},onFocus:function(e){E(!0),b==null||b(e)},onBlur:function(e){E(!1),F==null||F(e)},onCompositionStart:function(e){w.current=!0,L==null||L(e)},onCompositionEnd:function(e){w.current=!1,U(e,e.currentTarget.value),T==null||T(e)},className:x(l==null?void 0:l.textarea),style:i(i({},f==null?void 0:f.textarea),{},{resize:p==null?void 0:p.resize}),disabled:c,prefixCls:u,onResize:function(e){var o;D==null||D(e),(o=a())!==null&&o!==void 0&&o.style.height&&ce(!0)},ref:q,readOnly:V})))});module.exports=Se;

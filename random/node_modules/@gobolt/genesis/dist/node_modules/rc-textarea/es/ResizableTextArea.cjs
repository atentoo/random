"use strict";const L=require("../../@babel/runtime/helpers/esm/extends.cjs"),W=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),O=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),K=require("../../@babel/runtime/helpers/esm/typeof.cjs"),c=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),Q=require("../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),U=require("../../../_virtual/index.cjs"),Z=require("../../rc-resize-observer/es/index.cjs"),j=require("../../rc-util/es/hooks/useLayoutEffect.cjs"),$=require("../../rc-util/es/hooks/useMergedState.cjs"),C=require("../../rc-util/es/raf.cjs"),ee=require("react"),te=require("./calculateNodeHeight.cjs");function re(u){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(u){for(const e in u)if(e!=="default"){const o=Object.getOwnPropertyDescriptor(u,e);Object.defineProperty(i,e,o.get?o:{enumerable:!0,get:()=>u[e]})}}return i.default=u,Object.freeze(i)}const t=re(ee);var ne=["prefixCls","defaultValue","value","autoSize","onResize","className","style","disabled","onChange","onInternalAutoSize"],ue=t.forwardRef(function(u,i){var e=u,o=e.prefixCls,A=e.defaultValue,p=e.value,n=e.autoSize,s=e.onResize,D=e.className,I=e.style,q=e.disabled,b=e.onChange,R=e.onInternalAutoSize,T=Q(e,ne),V=$(A,{value:p,postState:function(r){return r??""}}),S=c(V,2),M=S[0],P=S[1],a=t.useRef();t.useImperativeHandle(i,function(){return{textArea:a.current}});var _=t.useMemo(function(){return n&&K(n)==="object"?[n.minRows,n.maxRows]:[]},[n]),g=c(_,2),z=g[0],y=g[1],f=!!n,H=t.useState(2),E=c(H,2),l=E[0],d=E[1],X=t.useState(),h=c(X,2),Y=h[0],k=h[1],w=function(){d(0),process.env.NODE_ENV==="test"&&(R==null||R())};j.default(function(){f&&w()},[p,z,y,f]),j.default(function(){if(l===0)d(1);else if(l===1){var r=te.default(a.current,!1,z,y);d(2),k(r)}else(function(){try{if(document.activeElement===a.current){var m=a.current,F=m.selectionStart,G=m.selectionEnd,J=m.scrollTop;a.current.setSelectionRange(F,G),a.current.scrollTop=J}}catch{}})()},[l]);var x=t.useRef(),N=function(){C.cancel(x.current)};t.useEffect(function(){return N},[]);var B=f?Y:null,v=O(O({},I),B);return l!==0&&l!==1||(v.overflowY="hidden",v.overflowX="hidden"),t.createElement(Z,{onResize:function(r){l===2&&(s==null||s(r),n&&(N(),x.current=C(function(){w()})))},disabled:!(n||s)},t.createElement("textarea",L({},T,{ref:a,style:v,className:U(o,D,W({},"".concat(o,"-disabled"),q)),disabled:q,value:M,onChange:function(r){P(r.target.value),b==null||b(r)}})))});module.exports=ue;

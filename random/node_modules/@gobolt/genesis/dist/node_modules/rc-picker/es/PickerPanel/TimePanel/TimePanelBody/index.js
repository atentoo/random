import h from "../../../../../@babel/runtime/helpers/esm/extends.js";
import b from "../../../../../@babel/runtime/helpers/esm/slicedToArray.js";
import * as o from "react";
import he from "../../../hooks/useTimeInfo.js";
import { formatValue as be } from "../../../utils/dateUtil.js";
import { usePanelContext as Se, PickerHackContext as xe } from "../../context.js";
import S from "./TimeColumn.js";
function c(r) {
  return r < 12;
}
function ke(r) {
  var te = r.showHour, oe = r.showMinute, ue = r.showSecond, re = r.showMillisecond, d = r.use12Hours, ie = r.changeOnScroll, s = Se(), le = s.prefixCls, U = s.values, n = s.generateConfig, D = s.locale, ae = s.onSelect, j = s.onHover, v = j === void 0 ? function() {
  } : j, x = s.pickerValue, g = (U == null ? void 0 : U[0]) || null, ce = o.useContext(xe).onCellDblClick, se = he(n, r, g), M = b(se, 5), fe = M[0], a = M[1], q = M[2], z = M[3], G = M[4], N = function(e) {
    return [g && n[e](g), x && n[e](x)];
  }, me = N("getHour"), I = b(me, 2), t = I[0], y = I[1], de = N("getMinute"), J = b(de, 2), V = J[0], O = J[1], ve = N("getSecond"), K = b(ve, 2), E = K[0], B = K[1], ge = N("getMillisecond"), L = b(ge, 2), w = L[0], F = L[1], Me = t === null ? null : c(t) ? "am" : "pm", pe = o.useMemo(function() {
    return d ? c(t) ? a.filter(function(e) {
      return c(e.value);
    }) : a.filter(function(e) {
      return !c(e.value);
    }) : a;
  }, [t, a, d]), T = function(e, u) {
    var f, C = e.filter(function(l) {
      return !l.disabled;
    });
    return u ?? (C == null || (f = C[0]) === null || f === void 0 ? void 0 : f.value);
  }, i = T(a, t), Q = o.useMemo(function() {
    return q(i);
  }, [q, i]), m = T(Q, V), R = o.useMemo(function() {
    return z(i, m);
  }, [z, i, m]), k = T(R, E), W = o.useMemo(function() {
    return G(i, m, k);
  }, [G, i, m, k]), X = T(W, w), He = o.useMemo(function() {
    if (!d) return [];
    var e = n.getNow(), u = n.setHour(e, 6), f = n.setHour(e, 18), C = function(l, Ce) {
      var ne = D.cellMeridiemFormat;
      return ne ? be(l, { generateConfig: n, locale: D, format: ne }) : Ce;
    };
    return [{ label: C(u, "AM"), value: "am", disabled: a.every(function(l) {
      return l.disabled || !c(l.value);
    }) }, { label: C(f, "PM"), value: "pm", disabled: a.every(function(l) {
      return l.disabled || c(l.value);
    }) }];
  }, [a, d, n, D]), p = function(e) {
    var u = fe(e);
    ae(u);
  }, P = o.useMemo(function() {
    var e = g || x || n.getNow(), u = function(f) {
      return f != null;
    };
    return u(t) ? (e = n.setHour(e, t), e = n.setMinute(e, V), e = n.setSecond(e, E), e = n.setMillisecond(e, w)) : u(y) ? (e = n.setHour(e, y), e = n.setMinute(e, O), e = n.setSecond(e, B), e = n.setMillisecond(e, F)) : u(i) && (e = n.setHour(e, i), e = n.setMinute(e, m), e = n.setSecond(e, k), e = n.setMillisecond(e, X)), e;
  }, [g, x, t, V, E, w, i, m, k, X, y, O, B, F, n]), A = function(e, u) {
    return e === null ? null : n[u](P, e);
  }, Y = function(e) {
    return A(e, "setHour");
  }, Z = function(e) {
    return A(e, "setMinute");
  }, _ = function(e) {
    return A(e, "setSecond");
  }, $ = function(e) {
    return A(e, "setMillisecond");
  }, ee = function(e) {
    return e === null ? null : e !== "am" || c(t) ? e === "pm" && c(t) ? n.setHour(P, t + 12) : P : n.setHour(P, t - 12);
  }, H = { onDblClick: ce, changeOnScroll: ie };
  return o.createElement("div", { className: "".concat(le, "-content") }, te && o.createElement(S, h({ units: pe, value: t, optionalValue: y, type: "hour", onChange: function(e) {
    p(Y(e));
  }, onHover: function(e) {
    v(Y(e));
  } }, H)), oe && o.createElement(S, h({ units: Q, value: V, optionalValue: O, type: "minute", onChange: function(e) {
    p(Z(e));
  }, onHover: function(e) {
    v(Z(e));
  } }, H)), ue && o.createElement(S, h({ units: R, value: E, optionalValue: B, type: "second", onChange: function(e) {
    p(_(e));
  }, onHover: function(e) {
    v(_(e));
  } }, H)), re && o.createElement(S, h({ units: W, value: w, optionalValue: F, type: "millisecond", onChange: function(e) {
    p($(e));
  }, onHover: function(e) {
    v($(e));
  } }, H)), d && o.createElement(S, h({ units: He, value: Me, type: "meridiem", onChange: function(e) {
    p(ee(e));
  }, onHover: function(e) {
    v(ee(e));
  } }, H)));
}
export {
  ke as default
};

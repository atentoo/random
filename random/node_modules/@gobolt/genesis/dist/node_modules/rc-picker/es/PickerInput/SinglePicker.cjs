"use strict";const _=require("../../../@babel/runtime/helpers/esm/extends.cjs"),ve=require("../../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),d=require("../../../@babel/runtime/helpers/esm/objectSpread2.cjs"),i=require("../../../@babel/runtime/helpers/esm/slicedToArray.cjs"),gn=require("../../../rc-util/es/hooks/useEvent.cjs"),Cn=require("../../../rc-util/es/hooks/useMergedState.cjs");require("../../../rc-util/es/ref.cjs"),require("../../../rc-util/es/warning.cjs");const ge=require("../../../rc-util/es/hooks/useLayoutEffect.cjs"),qn=require("../../../rc-util/es/omit.cjs"),hn=require("../../../rc-util/es/pickAttrs.cjs"),bn=require("react"),kn=require("../hooks/useToggleDates.cjs"),On=require("../PickerTrigger/index.cjs"),Pn=require("../PickerTrigger/util.cjs"),yn=require("../utils/miscUtil.cjs"),wn=require("./context.cjs"),Sn=require("./hooks/useCellRender.cjs"),Vn=require("./hooks/useFieldsInvalidate.cjs"),En=require("./hooks/useFilledProps.cjs"),Nn=require("./hooks/useOpen.cjs"),Dn=require("./hooks/usePickerRef.cjs"),In=require("./hooks/usePresets.cjs"),Rn=require("./hooks/useRangeActive.cjs"),Mn=require("./hooks/useRangePickerValue.cjs"),Ce=require("./hooks/useRangeValue.cjs"),jn=require("./hooks/useShowNow.cjs"),xn=require("./Popup/index.cjs"),Tn=require("./Selector/SingleSelector/index.cjs");function Fn(s){const h=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const m in s)if(m!=="default"){const l=Object.getOwnPropertyDescriptor(s,m);Object.defineProperty(h,m,l.get?l:{enumerable:!0,get:()=>s[m]})}}return h.default=s,Object.freeze(h)}const u=Fn(bn);function Bn(s,h){var m=En(s),l=i(m,6),f=l[0],S=l[1],z=l[2],R=l[3],A=l[4],M=l[5],n=f,G=n.prefixCls,he=n.styles,be=n.classNames,ke=n.order,Oe=n.defaultValue,Pe=n.value,j=n.needConfirm,J=n.onChange,L=n.onKeyDown,V=n.disabled,ye=n.disabledDate,we=n.minDate,Se=n.maxDate,Ve=n.defaultOpen,Ee=n.open,Ne=n.onOpenChange,b=n.locale,k=n.generateConfig,v=n.picker,De=n.showNow,Ie=n.showToday,g=n.showTime,Re=n.mode,Q=n.onPanelChange,U=n.onCalendarChange,W=n.onOk,a=n.multiple,Me=n.defaultPickerValue,je=n.pickerValue,X=n.onPickerValueChange,xe=n.inputReadOnly,Te=n.suffixIcon,Fe=n.removeIcon,Y=n.onFocus,Z=n.onBlur,Be=n.presets,E=n.components,He=n.cellRender,Ke=n.dateRender,_e=n.monthCellRender,$=n.onClick,x=Dn(h);function O(e){return e===null?null:a?e:e[0]}var ee=kn(k,b,S),ze=Nn(Ee,Ve,[V],Ne),ne=i(ze,2),o=ne[0],t=ne[1],Ae=Ce.useInnerValue(k,b,R,!1,ke,Oe,Pe,function(e,r,q){if(U){var I=d({},q);delete I.range,U(O(e),O(r),I)}},function(e){W==null||W(O(e))}),P=i(Ae,5),Ge=P[0],Je=P[1],y=P[2],T=P[3],Le=P[4],c=y(),Qe=Rn([V]),N=i(Qe,4),re=N[0],ue=N[1],D=N[2],F=N[3],oe=function(e){ue(!0),Y==null||Y(e,{})},te=function(e){ue(!1),Z==null||Z(e,{})},Ue=Cn(v,{value:Re}),ie=i(Ue,2),w=ie[0],We=ie[1],B=w==="date"&&g?"datetime":w,Xe=jn(v,w,De,Ie),Ye=J&&function(e,r){J(O(e),O(r))},Ze=Ce.default(d(d({},f),{},{onChange:Ye}),Ge,Je,y,T,[],R,re,o,M),H=i(Ze,2)[1],$e=Vn(c,M),le=i($e,2),ae=le[0],en=le[1],nn=u.useMemo(function(){return ae.some(function(e){return e})},[ae]),rn=Mn.default(k,b,c,[w],o,F,S,!1,Me,je,yn.toArray(g==null?void 0:g.defaultOpenValue),function(e,r){if(X){var q=d(d({},r),{},{mode:r.mode[0]});delete q.range,X(e[0],q)}},we,Se),ce=i(rn,2),un=ce[0],on=ce[1],fe=gn(function(e,r,q){if(We(r),Q&&q!==!1){var I=e||c[c.length-1];Q(I,r)}}),C=function(){H(y()),t(!1,{force:!0})},tn=u.useState(null),se=i(tn,2),ln=se[0],pe=se[1],an=u.useState(null),de=i(an,2),p=de[0],K=de[1],cn=u.useMemo(function(){var e=[p].concat(ve(c)).filter(function(r){return r});return a?e:e.slice(0,1)},[c,p,a]),fn=u.useMemo(function(){return!a&&p?[p]:c.filter(function(e){return e})},[c,p,a]);u.useEffect(function(){o||K(null)},[o]);var sn=In(Be),me=function(e){var r=a?ee(y(),e):[e];H(r)&&!a&&t(!1,{force:!0})},pn=Sn(He,Ke,_e),dn=u.useMemo(function(){var e=hn(f,!1),r=qn(f,[].concat(ve(Object.keys(e)),["onChange","onCalendarChange","style","className","onPanelChange"]));return d(d({},r),{},{multiple:f.multiple})},[f]),mn=u.createElement(xn,_({},dn,{showNow:Xe,showTime:g,disabledDate:ye,onFocus:function(e){t(!0),oe(e)},onBlur:te,picker:v,mode:w,internalMode:B,onPanelChange:fe,format:A,value:c,isInvalid:M,onChange:null,onSelect:function(e){if(D("panel"),!a||B===v){var r=a?ee(y(),e):[e];T(r),j||z||S!==B||C()}},pickerValue:un,defaultOpenValue:g==null?void 0:g.defaultOpenValue,onPickerValueChange:on,hoverValue:cn,onHover:function(e){K(e),pe("cell")},needConfirm:j,onSubmit:C,onOk:Le,presets:sn,onPresetHover:function(e){K(e),pe("preset")},onPresetSubmit:me,onNow:function(e){me(e)},cellRender:pn})),vn=u.useMemo(function(){return{prefixCls:G,locale:b,generateConfig:k,button:E.button,input:E.input}},[G,b,k,E.button,E.input]);return ge.default(function(){o&&F!==void 0&&fe(null,v,!1)},[o,F,v]),ge.default(function(){var e=D();o||e!=="input"||(t(!1),C()),o||!z||j||e!=="panel"||C()},[o]),u.createElement(wn.Provider,{value:vn},u.createElement(On,_({},Pn.pickTriggerProps(f),{popupElement:mn,popupStyle:he.popup,popupClassName:be.popup,visible:o,onClose:function(){t(!1)}}),u.createElement(Tn,_({},f,{ref:x,suffixIcon:Te,removeIcon:Fe,activeHelp:!!p,allHelp:!!p&&ln==="preset",focused:re,onFocus:function(e){D("input"),t(!0,{inherit:!0}),oe(e)},onBlur:function(e){t(!1),te(e)},onKeyDown:function(e,r){e.key==="Tab"&&C(),L==null||L(e,r)},onSubmit:C,value:fn,maskFormat:A,onChange:function(e){T(e)},onInputChange:function(){D("input")},internalPicker:S,format:R,inputReadOnly:xe,disabled:V,open:o,onOpenChange:t,onClick:function(e){V||x.current.nativeElement.contains(document.activeElement)||x.current.focus(),t(!0),$==null||$(e)},onClear:function(){H(null),t(!1,{force:!0})},invalid:nn,onInvalid:function(e){en(e,0)}}))))}var qe=u.forwardRef(Bn);process.env.NODE_ENV!=="production"&&(qe.displayName="RefPicker"),module.exports=qe;

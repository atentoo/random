import A from "../../../../@babel/runtime/helpers/esm/defineProperty.js";
import L from "../../../../@babel/runtime/helpers/esm/extends.js";
import c from "../../../../@babel/runtime/helpers/esm/slicedToArray.js";
import V from "../../../../../_virtual/index.js";
import ge from "../../../../rc-resize-observer/es/index.js";
import * as t from "react";
import { toArray as he } from "../../utils/miscUtil.js";
import we from "../context.js";
import Ee from "./Footer.js";
import Me from "./PopupPanel.js";
import Se from "./PresetPanel.js";
function Ie(e) {
  var M = e.panelRender, W = e.internalMode, S = e.picker, j = e.showNow, m = e.range, q = e.multiple, x = e.activeInfo, G = x === void 0 ? [0, 0, 0] : x, J = e.presets, K = e.onPresetHover, Q = e.onPresetSubmit, T = e.onFocus, U = e.onBlur, N = e.onPanelMouseDown, X = e.direction, R = e.value, Y = e.onSelect, y = e.isInvalid, l = e.defaultOpenValue, Z = e.onOk, _ = e.onSubmit, r = t.useContext(we).prefixCls, $ = "".concat(r, "-panel"), o = X === "rtl", C = t.useRef(null), v = t.useRef(null), ee = t.useState(0), b = c(ee, 2), a = b[0], te = b[1], ne = t.useState(0), P = c(ne, 2), re = P[0], k = P[1], oe = t.useState(0), B = c(oe, 2), ae = B[0], ie = B[1], d = c(G, 3), f = d[0], g = d[1], D = d[2], ue = t.useState(0), I = c(ue, 2), ce = I[0], F = I[1];
  function H(n) {
    return n.filter(function(i) {
      return i;
    });
  }
  t.useEffect(function() {
    F(10);
  }, [f]), t.useEffect(function() {
    if (m && v.current) {
      var n, i = ((n = C.current) === null || n === void 0 ? void 0 : n.offsetWidth) || 0, u = v.current.getBoundingClientRect();
      if (!u.height || u.right < 0) return void F(function(de) {
        return Math.max(0, de - 1);
      });
      var pe = (o ? g - i : f) - u.left;
      if (ie(pe), a && a < D) {
        var me = o ? u.right - (g - i + a) : f + i - u.left - a, ve = Math.max(0, me);
        k(ve);
      } else k(0);
    }
  }, [ce, o, a, f, g, D, m]);
  var s = t.useMemo(function() {
    return H(he(R));
  }, [R]), p = S === "time" && !s.length, h = t.useMemo(function() {
    return p ? H([l]) : s;
  }, [p, s, l]), le = p ? l : s, fe = t.useMemo(function() {
    return !h.length || h.some(function(n) {
      return y(n);
    });
  }, [h, y]), w = t.createElement("div", { className: "".concat(r, "-panel-layout") }, t.createElement(Se, { prefixCls: r, presets: J, onClick: Q, onHover: K }), t.createElement("div", null, t.createElement(Me, L({}, e, { value: le })), t.createElement(Ee, L({}, e, { showNow: !q && j, invalid: fe, onSubmit: function() {
    p && Y(l), Z(), _();
  } }))));
  M && (w = M(w));
  var se = "".concat($, "-container"), O = "marginLeft", z = "marginRight", E = t.createElement("div", { onMouseDown: N, tabIndex: -1, className: V(se, "".concat(r, "-").concat(W, "-panel-container")), style: A(A({}, o ? z : O, re), o ? O : z, "auto"), onFocus: T, onBlur: U }, w);
  return m && (E = t.createElement("div", { onMouseDown: N, ref: v, className: V("".concat(r, "-range-wrapper"), "".concat(r, "-").concat(S, "-range-wrapper")) }, t.createElement("div", { ref: C, className: "".concat(r, "-range-arrow"), style: { left: ae } }), t.createElement(ge, { onResize: function(n) {
    n.width && te(n.width);
  } }, E))), E;
}
export {
  Ie as default
};

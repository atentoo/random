import P from "../../@babel/runtime/helpers/esm/extends.js";
import A from "../../@babel/runtime/helpers/esm/objectWithoutProperties.js";
import l from "../../@babel/runtime/helpers/esm/objectSpread2.js";
import R from "../../@babel/runtime/helpers/esm/classCallCheck.js";
import D from "../../@babel/runtime/helpers/esm/createClass.js";
import h from "../../@babel/runtime/helpers/esm/assertThisInitialized.js";
import K from "../../@babel/runtime/helpers/esm/inherits.js";
import V from "../../@babel/runtime/helpers/esm/createSuper.js";
import d from "../../@babel/runtime/helpers/esm/defineProperty.js";
import * as v from "react";
import M from "./CSSMotion.js";
import { STATUS_REMOVED as y, parseKeys as U, diffKeys as _, STATUS_REMOVE as O, STATUS_ADD as x, STATUS_KEEP as F } from "./util/diff.js";
import { supportTransition as N } from "./util/motion.js";
var w = ["component", "children", "onVisibleChanged", "onAllRemoved"], I = ["status"], j = ["eventProps", "visible", "children", "motionName", "motionAppear", "motionEnter", "motionLeave", "motionLeaveImmediately", "motionDeadline", "removeOnLeave", "leavedClassName", "onAppearPrepare", "onAppearStart", "onAppearActive", "onAppearEnd", "onEnterStart", "onEnterActive", "onEnterEnd", "onLeaveStart", "onLeaveActive", "onLeaveEnd"];
function q(z) {
  var g = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : M, E = function(C) {
    K(s, C);
    var k = V(s);
    function s() {
      var e;
      R(this, s);
      for (var i = arguments.length, n = new Array(i), r = 0; r < i; r++) n[r] = arguments[r];
      return e = k.call.apply(k, [this].concat(n)), d(h(e), "state", { keyEntities: [] }), d(h(e), "removeKey", function(m) {
        e.setState(function(o) {
          return { keyEntities: o.keyEntities.map(function(t) {
            return t.key !== m ? t : l(l({}, t), {}, { status: y });
          }) };
        }, function() {
          e.state.keyEntities.filter(function(o) {
            return o.status !== y;
          }).length === 0 && e.props.onAllRemoved && e.props.onAllRemoved();
        });
      }), e;
    }
    return D(s, [{ key: "render", value: function() {
      var e = this, i = this.state.keyEntities, n = this.props, r = n.component, m = n.children, o = n.onVisibleChanged;
      n.onAllRemoved;
      var t = A(n, w), c = r || v.Fragment, p = {};
      return j.forEach(function(a) {
        p[a] = t[a], delete t[a];
      }), delete t.keys, v.createElement(c, t, i.map(function(a, T) {
        var S = a.status, u = A(a, I), L = S === x || S === F;
        return v.createElement(g, P({}, p, { key: u.key, visible: L, eventProps: u, onVisibleChanged: function(f) {
          o == null || o(f, { key: u.key }), f || e.removeKey(u.key);
        } }), function(f, b) {
          return m(l(l({}, f), {}, { index: T }), b);
        });
      }));
    } }], [{ key: "getDerivedStateFromProps", value: function(e, i) {
      var n = e.keys, r = i.keyEntities, m = U(n);
      return { keyEntities: _(r, m).filter(function(o) {
        var t = r.find(function(c) {
          var p = c.key;
          return o.key === p;
        });
        return !t || t.status !== y || o.status !== O;
      }) };
    } }]), s;
  }(v.Component);
  return d(E, "defaultProps", { component: "div" }), E;
}
const ne = q(N);
export {
  ne as default,
  q as genCSSMotionList
};

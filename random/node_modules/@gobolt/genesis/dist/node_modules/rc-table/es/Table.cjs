"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const v=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),T=require("../../@babel/runtime/helpers/esm/extends.cjs"),x=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),i=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),Ee=require("../../../_virtual/index.cjs"),on=require("../../rc-resize-observer/es/index.cjs"),ln=require("../../rc-util/es/Dom/isVisible.cjs"),an=require("../../rc-util/es/Dom/styleChecker.cjs"),ft=require("../../rc-util/es/getScrollBarSize.cjs"),mt=require("../../rc-util/es/hooks/useEvent.cjs"),pt=require("../../rc-util/es/pickAttrs.cjs"),cn=require("../../rc-util/es/utils/get.cjs"),Q=require("../../rc-util/es/warning.cjs"),un=require("react"),sn=require("./Body/index.cjs"),dn=require("./ColGroup.cjs"),we=require("./constant.cjs"),wt=require("./context/TableContext.cjs"),yt=require("./FixedHolder/index.cjs"),z=require("./Footer/index.cjs"),fn=require("./Footer/Summary.cjs"),vt=require("./Header/Header.cjs"),mn=require("./hooks/useColumns/index.cjs"),pn=require("./hooks/useExpand.cjs"),yn=require("./hooks/useFixedInfo.cjs"),xt=require("./hooks/useFrame.cjs"),vn=require("./hooks/useHover.cjs"),xn=require("./hooks/useSticky.cjs"),En=require("./hooks/useStickyOffsets.cjs"),Et=require("./Panel/index.cjs"),wn=require("./stickyScrollBar.cjs"),gn=require("./sugar/Column.cjs"),hn=require("./sugar/ColumnGroup.cjs"),Z=require("./utils/valueUtil.cjs"),bn=require("../../rc-util/es/Dom/findDOMNode.cjs");function Cn(E){const I=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(E){for(const n in E)if(n!=="default"){const o=Object.getOwnPropertyDescriptor(E,n);Object.defineProperty(I,n,o.get?o:{enumerable:!0,get:()=>E[n]})}}return I.default=E,Object.freeze(I)}const e=Cn(un);var gt="rc-table",Sn=[],Nn={};function Rn(){return"No Data"}function qn(E,I){var n=i({rowKey:"key",prefixCls:gt,emptyText:Rn},E),o=n.prefixCls,Ct=n.className,ge=n.rowClassName,St=n.style,he=n.data,D=n.rowKey,b=n.scroll,$=n.tableLayout,w=n.direction,be=n.title,Ce=n.footer,ee=n.summary,Se=n.caption,Nt=n.id,Ne=n.showHeader,Re=n.components,B=n.emptyText,qe=n.onRow,Rt=n.onHeaderRow,ke=n.onScroll,qt=n.internalHooks,kt=n.transformColumns,Oe=n.internalRefs,te=n.tailor,Te=n.getContainerWidth,Ot=n.sticky,Le=n.rowHoverable,Ie=Le===void 0||Le,p=he||Sn,ne=!!p.length,S=qt===we.INTERNAL_HOOKS;process.env.NODE_ENV!=="production"&&(["onRowClick","onRowDoubleClick","onRowContextMenu","onRowMouseEnter","onRowMouseLeave"].forEach(function(t){Q.warningOnce(n[t]===void 0,"`".concat(t,"` is removed, please use `onRow` instead."))}),Q.warningOnce(!("getBodyWrapper"in n),"`getBodyWrapper` is deprecated, please use custom `components` instead."));var K=e.useCallback(function(t,r){return cn(Re,t)||r},[Re]),M=e.useMemo(function(){return typeof D=="function"?D:function(t){var r=t&&t[D];return process.env.NODE_ENV!=="production"&&Q.warningOnce(r!==void 0,"Each record in table should have a unique `key` prop, or set `rowKey` to an unique primary key."),r}},[D]),Me=K(["body"]),Tt=vn(),re=x(Tt,3),He=re[0],We=re[1],_e=re[2],Lt=pn(n,p,M),N=x(Lt,6),u=N[0],ze=N[1],oe=N[2],le=N[3],De=N[4],ae=N[5],ce=b==null?void 0:b.x,It=e.useState(0),Be=x(It,2),V=Be[0],Mt=Be[1],Ht=mn.default(i(i(i({},n),u),{},{expandable:!!u.expandedRowRender,columnTitle:u.columnTitle,expandedKeys:oe,getRowKey:M,onTriggerExpand:ae,expandIcon:le,expandIconColumnIndex:u.expandIconColumnIndex,direction:w,scrollWidth:S&&te&&typeof ce=="number"?ce:null,clientWidth:V}),S?kt:null),P=x(Ht,4),H=P[0],l=P[1],Ke=P[2],Wt=P[3],g=Ke??ce,Ve=e.useMemo(function(){return{columns:H,flattenColumns:l}},[H,l]),C=e.useRef(),ue=e.useRef(),a=e.useRef(),Pe=e.useRef();e.useImperativeHandle(I,function(){return{nativeElement:C.current,scrollTo:function(t){var r;if(a.current instanceof HTMLElement){var s=t.index,c=t.top,J=t.key;if(Z.validNumberValue(c)){var d;(d=a.current)===null||d===void 0||d.scrollTo({top:c})}else{var O,_=J??M(p[s]);(O=a.current.querySelector('[data-row-key="'.concat(_,'"]')))===null||O===void 0||O.scrollIntoView()}}else(r=a.current)!==null&&r!==void 0&&r.scrollTo&&a.current.scrollTo(t)}}});var ie,j,se,je=e.useRef(),_t=e.useState(!1),Ae=x(_t,2),zt=Ae[0],A=Ae[1],Dt=e.useState(!1),Fe=x(Dt,2),Bt=Fe[0],F=Fe[1],Kt=xt.useLayoutState(new Map),Xe=x(Kt,2),Vt=Xe[0],Pt=Xe[1],Ue=Z.getColumnsKey(l).map(function(t){return Vt.get(t)}),Ye=e.useMemo(function(){return Ue},[Ue.join("_")]),X=En(Ye,l,w),f=b&&Z.validateValue(b.y),y=b&&Z.validateValue(g)||!!u.fixed,R=y&&l.some(function(t){return t.fixed}),de=e.useRef(),q=xn(Ot,o),h=q.isSticky,jt=q.offsetHeader,At=q.offsetSummary,Ft=q.offsetScroll,Xt=q.stickyClassName,Ut=q.container,m=e.useMemo(function(){return ee==null?void 0:ee(p)},[ee,p]),W=(f||h)&&e.isValidElement(m)&&m.type===fn&&m.props.fixed;f&&(j={overflowY:ne?"scroll":"auto",maxHeight:b.y}),y&&(ie={overflowX:"auto"},f||(j={overflowY:"hidden"}),se={width:g===!0?"auto":g,minWidth:"100%"});var Ge=e.useCallback(function(t,r){ln(C.current)&&Pt(function(s){if(s.get(t)!==r){var c=new Map(s);return c.set(t,r),c}return s})},[]),Yt=xt.useTimeoutLock(),Je=x(Yt,2),Gt=Je[0],Qe=Je[1];function U(t,r){r&&(typeof r=="function"?r(t):r.scrollLeft!==t&&(r.scrollLeft=t,r.scrollLeft!==t&&setTimeout(function(){r.scrollLeft=t},0)))}var k=mt(function(t){var r,s=t.currentTarget,c=t.scrollLeft,J=w==="rtl",d=typeof c=="number"?c:s.scrollLeft,O=s||Nn;Qe()&&Qe()!==O||(Gt(O),U(d,ue.current),U(d,a.current),U(d,je.current),U(d,(r=de.current)===null||r===void 0?void 0:r.setScrollLeft));var _=s||ue.current;if(_){var ve=S&&te&&typeof g=="number"?g:_.scrollWidth,xe=_.clientWidth;if(ve===xe)return A(!1),void F(!1);J?(A(-d<ve-xe),F(-d>0)):(A(d>0),F(d<ve-xe))}}),Jt=mt(function(t){k(t),ke==null||ke(t)}),Ze=function(){var t;y&&a.current?k({currentTarget:bn.getDOM(a.current),scrollLeft:(t=a.current)===null||t===void 0?void 0:t.scrollLeft}):(A(!1),F(!1))},$e=e.useRef(!1);e.useEffect(function(){$e.current&&Ze()},[y,he,H.length]),e.useEffect(function(){$e.current=!0},[]);var Qt=e.useState(0),et=x(Qt,2),Y=et[0],tt=et[1],Zt=e.useState(!0),nt=x(Zt,2),rt=nt[0],$t=nt[1];e.useEffect(function(){te&&S||(a.current instanceof Element?tt(ft.getTargetScrollBarSize(a.current).width):tt(ft.getTargetScrollBarSize(Pe.current).width)),$t(an.isStyleSupport("position","sticky"))},[]),e.useEffect(function(){S&&Oe&&(Oe.body.current=a.current)});var fe,en=e.useCallback(function(t){return e.createElement(e.Fragment,null,e.createElement(vt,t),W==="top"&&e.createElement(z.default,t,m))},[W,m]),tn=e.useCallback(function(t){return e.createElement(z.default,t,m)},[m]),ot=K(["table"],"table"),G=e.useMemo(function(){return $||(R?g==="max-content"?"auto":"fixed":f||h||l.some(function(t){return t.ellipsis})?"fixed":"auto")},[f,R,l,$,h]),me={colWidths:Ye,columCount:l.length,stickyOffsets:X,onHeaderRow:Rt,fixHeader:f,scroll:b},lt=e.useMemo(function(){return ne?null:typeof B=="function"?B():B},[ne,B]),at=e.createElement(sn,{data:p,measureColumnWidth:f||y||h}),ct=e.createElement(dn,{colWidths:l.map(function(t){return t.width}),columns:l}),ut=Se!=null?e.createElement("caption",{className:"".concat(o,"-caption")},Se):void 0,nn=pt(n,{data:!0}),it=pt(n,{aria:!0});if(f||h){var pe;typeof Me=="function"?(pe=Me(p,{scrollbarSize:Y,ref:a,onScroll:k}),me.colWidths=l.map(function(t,r){var s=t.width,c=r===l.length-1?s-Y:s;return typeof c!="number"||Number.isNaN(c)?(process.env.NODE_ENV!=="production"&&Q.warningOnce(n.columns.length===0,"When use `components.body` with render props. Each column should have a fixed `width` value."),0):c})):pe=e.createElement("div",{style:i(i({},ie),j),onScroll:Jt,ref:a,className:Ee("".concat(o,"-body"))},e.createElement(ot,T({style:i(i({},se),{},{tableLayout:G})},it),ut,ct,at,!W&&m&&e.createElement(z.default,{stickyOffsets:X,flattenColumns:l},m)));var st=i(i(i({noData:!p.length,maxContentScroll:y&&g==="max-content"},me),Ve),{},{direction:w,stickyClassName:Xt,onScroll:k});fe=e.createElement(e.Fragment,null,Ne!==!1&&e.createElement(yt,T({},st,{stickyTopOffset:jt,className:"".concat(o,"-header"),ref:ue}),en),pe,W&&W!=="top"&&e.createElement(yt,T({},st,{stickyBottomOffset:At,className:"".concat(o,"-summary"),ref:je}),tn),h&&a.current&&a.current instanceof Element&&e.createElement(wn,{ref:de,offsetScroll:Ft,scrollBodyRef:a,onScroll:k,container:Ut,direction:w}))}else fe=e.createElement("div",{style:i(i({},ie),j),className:Ee("".concat(o,"-content")),onScroll:k,ref:a},e.createElement(ot,T({style:i(i({},se),{},{tableLayout:G})},it),ut,ct,Ne!==!1&&e.createElement(vt,T({},me,Ve)),at,m&&e.createElement(z.default,{stickyOffsets:X,flattenColumns:l},m)));var ye=e.createElement("div",T({className:Ee(o,Ct,v(v(v(v(v(v(v(v(v(v({},"".concat(o,"-rtl"),w==="rtl"),"".concat(o,"-ping-left"),zt),"".concat(o,"-ping-right"),Bt),"".concat(o,"-layout-fixed"),$==="fixed"),"".concat(o,"-fixed-header"),f),"".concat(o,"-fixed-column"),R),"".concat(o,"-fixed-column-gapped"),R&&Wt),"".concat(o,"-scroll-horizontal"),y),"".concat(o,"-has-fix-left"),l[0]&&l[0].fixed),"".concat(o,"-has-fix-right"),l[l.length-1]&&l[l.length-1].fixed==="right")),style:St,id:Nt,ref:C},nn),be&&e.createElement(Et,{className:"".concat(o,"-title")},be(p)),e.createElement("div",{ref:Pe,className:"".concat(o,"-container")},fe),Ce&&e.createElement(Et,{className:"".concat(o,"-footer")},Ce(p)));y&&(ye=e.createElement(on,{onResize:function(t){var r,s=t.width;(r=de.current)===null||r===void 0||r.checkScrollBarVisible();var c=C.current?C.current.offsetWidth:s;S&&Te&&C.current&&(c=Te(C.current,c)||c),c!==V&&(Ze(),Mt(c))}},ye));var dt=yn(l,X,w),rn=e.useMemo(function(){return{scrollX:g,prefixCls:o,getComponent:K,scrollbarSize:Y,direction:w,fixedInfoList:dt,isSticky:h,supportSticky:rt,componentWidth:V,fixHeader:f,fixColumn:R,horizonScroll:y,tableLayout:G,rowClassName:ge,expandedRowClassName:u.expandedRowClassName,expandIcon:le,expandableType:ze,expandRowByClick:u.expandRowByClick,expandedRowRender:u.expandedRowRender,onTriggerExpand:ae,expandIconColumnIndex:u.expandIconColumnIndex,indentSize:u.indentSize,allColumnsFixedLeft:l.every(function(t){return t.fixed==="left"}),emptyNode:lt,columns:H,flattenColumns:l,onColumnResize:Ge,hoverStartRow:He,hoverEndRow:We,onHover:_e,rowExpandable:u.rowExpandable,onRow:qe,getRowKey:M,expandedKeys:oe,childrenColumnName:De,rowHoverable:Ie}},[g,o,K,Y,w,dt,h,rt,V,f,R,y,G,ge,u.expandedRowClassName,le,ze,u.expandRowByClick,u.expandedRowRender,ae,u.expandIconColumnIndex,u.indentSize,lt,H,l,Ge,He,We,_e,u.rowExpandable,qe,M,oe,De,Ie]);return e.createElement(wt.default.Provider,{value:rn},ye)}var ht=e.forwardRef(qn);function bt(E){return wt.makeImmutable(ht,E)}process.env.NODE_ENV!=="production"&&(ht.displayName="Table");var L=bt();L.EXPAND_COLUMN=we.EXPAND_COLUMN,L.INTERNAL_HOOKS=we.INTERNAL_HOOKS,L.Column=gn,L.ColumnGroup=hn,L.Summary=z.FooterComponents,exports.DEFAULT_PREFIX=gt,exports.default=L,exports.genTable=bt;

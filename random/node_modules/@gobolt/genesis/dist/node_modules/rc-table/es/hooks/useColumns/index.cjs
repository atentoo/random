"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const $=require("../../../../@babel/runtime/helpers/esm/slicedToArray.cjs"),E=require("../../../../@babel/runtime/helpers/esm/defineProperty.cjs"),b=require("../../../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),k=require("../../../../@babel/runtime/helpers/esm/typeof.cjs"),g=require("../../../../@babel/runtime/helpers/esm/objectSpread2.cjs"),S=require("../../../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),ee=require("../../../../rc-util/es/Children/toArray.cjs"),L=require("../../../../rc-util/es/warning.cjs"),ne=require("react"),a=require("../../constant.cjs"),re=require("../../utils/legacyUtil.cjs"),te=require("./useWidthColumns.cjs");function ie(e){const n=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const u=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,u.get?u:{enumerable:!0,get:()=>e[r]})}}return n.default=e,Object.freeze(n)}const x=ie(ne);var ue=["children"],oe=["fixed"];function A(e){return ee(e).filter(function(n){return x.isValidElement(n)}).map(function(n){var r=n.key,u=n.props,p=u.children,N=S(u,ue),f=g({key:r},N);return p&&(f.children=A(p)),f})}function V(e){return e.filter(function(n){return n&&k(n)==="object"&&!n.hidden}).map(function(n){var r=n.children;return r&&r.length>0?g(g({},n),{},{children:V(r)}):n})}function U(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"key";return e.filter(function(r){return r&&k(r)==="object"}).reduce(function(r,u,p){var N=u.fixed,f=N===!0?"left":N,O="".concat(n,"-").concat(p),h=u.children;return h&&h.length>0?[].concat(b(r),b(U(h,O).map(function(P){return g({fixed:f},P)}))):[].concat(b(r),[g(g({key:O},u),{},{fixed:f})])},[])}exports.convertChildrenToColumns=A,exports.default=function(e,n){var r=e.prefixCls,u=e.columns,p=e.children,N=e.expandable,f=e.expandedKeys,O=e.columnTitle,h=e.getRowKey,P=e.onTriggerExpand,X=e.expandIcon,q=e.rowExpandable,y=e.expandIconColumnIndex,C=e.direction,R=e.expandRowByClick,W=e.columnWidth,M=e.fixed,T=e.scrollWidth,K=e.clientWidth,v=x.useMemo(function(){return V((u||A(p)||[]).slice())},[u,p]),w=x.useMemo(function(){if(N){var t=v.slice();if(process.env.NODE_ENV!=="production"&&y>=0&&L.warningOnce(!1,"`expandIconColumnIndex` is deprecated. Please use `Table.EXPAND_COLUMN` in `columns` instead."),!t.includes(a.EXPAND_COLUMN)){var o=y||0;o>=0&&(o||M==="left"||!M)&&t.splice(o,0,a.EXPAND_COLUMN),M==="right"&&t.splice(v.length,0,a.EXPAND_COLUMN)}process.env.NODE_ENV!=="production"&&t.filter(function(i){return i===a.EXPAND_COLUMN}).length>1&&L.warningOnce(!1,"There exist more than one `EXPAND_COLUMN` in `columns`.");var c=t.indexOf(a.EXPAND_COLUMN);t=t.filter(function(i,m){return i!==a.EXPAND_COLUMN||m===c});var s,l=v[c];s=M||(l?l.fixed:null);var D=E(E(E(E(E(E({},re.INTERNAL_COL_DEFINE,{className:"".concat(r,"-expand-icon-col"),columnType:"EXPAND_COLUMN"}),"title",O),"fixed",s),"className","".concat(r,"-row-expand-icon-cell")),"width",W),"render",function(i,m,G){var J=h(m,G),Q=f.has(J),Y=!q||q(m),j=X({prefixCls:r,expanded:Q,expandable:Y,record:m,onExpand:P});return R?x.createElement("span",{onClick:function(Z){return Z.stopPropagation()}},j):j});return t.map(function(i){return i===a.EXPAND_COLUMN?D:i})}return process.env.NODE_ENV!=="production"&&v.includes(a.EXPAND_COLUMN)&&L.warningOnce(!1,"`expandable` is not config but there exist `EXPAND_COLUMN` in `columns`."),v.filter(function(i){return i!==a.EXPAND_COLUMN})},[N,v,h,f,X,C]),_=x.useMemo(function(){var t=w;return n&&(t=n(t)),t.length||(t=[{render:function(){return null}}]),t},[n,w,C]),d=x.useMemo(function(){return C==="rtl"?function(t){return t.map(function(o){var c=o.fixed,s=S(o,oe),l=c;return c==="left"?l="right":c==="right"&&(l="left"),g({fixed:l},s)})}(U(_)):U(_)},[_,C,T]),z=x.useMemo(function(){for(var t=-1,o=d.length-1;o>=0;o-=1){var c=d[o].fixed;if(c==="left"||c===!0){t=o;break}}if(t>=0)for(var s=0;s<=t;s+=1){var l=d[s].fixed;if(l!=="left"&&l!==!0)return!0}var D=d.findIndex(function(m){return m.fixed==="right"});if(D>=0){for(var i=D;i<d.length;i+=1)if(d[i].fixed!=="right")return!0}return!1},[d]),B=te(d,T,K),I=$(B,2),F=I[0],H=I[1];return[_,F,H,z]};

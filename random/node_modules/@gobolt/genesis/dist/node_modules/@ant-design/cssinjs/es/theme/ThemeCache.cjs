"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const o=require("../../../../@babel/runtime/helpers/esm/slicedToArray.cjs"),f=require("../../../../@babel/runtime/helpers/esm/classCallCheck.cjs"),m=require("../../../../@babel/runtime/helpers/esm/createClass.cjs"),v=require("../../../../@babel/runtime/helpers/esm/defineProperty.cjs");function d(l,t){if(l.length!==t.length)return!1;for(var e=0;e<l.length;e++)if(l[e]!==t[e])return!1;return!0}var c=function(){function l(){f(this,l),v(this,"cache",void 0),v(this,"keys",void 0),v(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return m(l,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(t){var e,a,n=arguments.length>1&&arguments[1]!==void 0&&arguments[1],s={map:this.cache};return t.forEach(function(r){var i;s?s=(i=s)===null||i===void 0||(i=i.map)===null||i===void 0?void 0:i.get(r):s=void 0}),(e=s)!==null&&e!==void 0&&e.value&&n&&(s.value[1]=this.cacheCallTimes++),(a=s)===null||a===void 0?void 0:a.value}},{key:"get",value:function(t){var e;return(e=this.internalGet(t,!0))===null||e===void 0?void 0:e[0]}},{key:"has",value:function(t){return!!this.internalGet(t)}},{key:"set",value:function(t,e){var a=this;if(!this.has(t)){if(this.size()+1>l.MAX_CACHE_SIZE+l.MAX_CACHE_OFFSET){var n=this.keys.reduce(function(i,u){var h=o(i,2)[1];return a.internalGet(u)[1]<h?[u,a.internalGet(u)[1]]:i},[this.keys[0],this.cacheCallTimes]),s=o(n,1)[0];this.delete(s)}this.keys.push(t)}var r=this.cache;t.forEach(function(i,u){if(u===t.length-1)r.set(i,{value:[e,a.cacheCallTimes++]});else{var h=r.get(i);h?h.map||(h.map=new Map):r.set(i,{map:new Map}),r=r.get(i).map}})}},{key:"deleteByPath",value:function(t,e){var a,n=t.get(e[0]);if(e.length===1)return n.map?t.set(e[0],{map:n.map}):t.delete(e[0]),(a=n.value)===null||a===void 0?void 0:a[0];var s=this.deleteByPath(n.map,e.slice(1));return n.map&&n.map.size!==0||n.value||t.delete(e[0]),s}},{key:"delete",value:function(t){if(this.has(t))return this.keys=this.keys.filter(function(e){return!d(e,t)}),this.deleteByPath(this.cache,t)}}]),l}();v(c,"MAX_CACHE_SIZE",20),v(c,"MAX_CACHE_OFFSET",5),exports.default=c,exports.sameDerivativeOption=d;

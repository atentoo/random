"use strict";const me=require("../../@babel/runtime/helpers/esm/extends.cjs"),a=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),A=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),he=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),De=require("../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),t=require("react"),u=require("../../../_virtual/index.cjs"),Ee=require("../../rc-util/es/pickAttrs.cjs"),F=require("./contextTypes.cjs"),ke=require("./Indent.cjs"),H=require("./utils/keyUtil.cjs"),i=require("./utils/treeUtil.cjs");var Me=["eventKey","className","style","dragOver","dragOverGapTop","dragOverGapBottom","isLeaf","isStart","isEnd","expanded","selected","checked","halfChecked","loading","domRef","active","data","onMouseMove","selectable"],J="open",Q="close",L=function(o){var k,M,y,l=o.eventKey,W=o.className,X=o.style,Y=o.dragOver,Z=o.dragOverGapTop,$=o.dragOverGapBottom,C=o.isLeaf,ee=o.isStart,P=o.isEnd,d=o.expanded,q=o.selected,f=o.checked,h=o.halfChecked,s=o.loading,oe=o.domRef,ne=o.active,v=o.data,te=o.onMouseMove,b=o.selectable,ae=De(o,Me),e=t.useContext(F.TreeContext),w=t.useContext(F.UnstableContext),re=t.useRef(null),ce=t.useState(!1),S=he(ce,2),ie=S[0],T=S[1],c=!!(e.disabled||o.disabled||(k=w.nodeDisabled)!==null&&k!==void 0&&k.call(w,v)),N=t.useMemo(function(){return!(!e.checkable||o.checkable===!1)&&e.checkable},[e.checkable,o.checkable]),R=function(n){c||N&&!o.disableCheckbox&&e.onNodeCheck(n,i.convertNodePropsToEventData(o),!f)},le=t.useMemo(function(){return typeof b=="boolean"?b:e.selectable},[b,e.selectable]),I=function(n){e.onNodeClick(n,i.convertNodePropsToEventData(o)),le?function(r){c||e.onNodeSelect(r,i.convertNodePropsToEventData(o))}(n):R(n)},K=function(n){e.onNodeDoubleClick(n,i.convertNodePropsToEventData(o))},_=function(n){e.onNodeMouseEnter(n,i.convertNodePropsToEventData(o))},B=function(n){e.onNodeMouseLeave(n,i.convertNodePropsToEventData(o))},G=function(n){e.onNodeContextMenu(n,i.convertNodePropsToEventData(o))},p=t.useMemo(function(){return!(!e.draggable||e.draggable.nodeDraggable&&!e.draggable.nodeDraggable(v))},[e.draggable,v]),de=function(n){s||e.onNodeExpand(n,i.convertNodePropsToEventData(o))},g=t.useMemo(function(){var n=(H(e.keyEntities,l)||{}).children;return!!(n||[]).length},[e.keyEntities,l]),x=t.useMemo(function(){return C!==!1&&(C||!e.loadData&&!g||e.loadData&&o.loaded&&!g)},[C,e.loadData,g,o.loaded]);t.useEffect(function(){s||typeof e.loadData!="function"||!d||x||o.loaded||e.onNodeLoad(i.convertNodePropsToEventData(o))},[s,e.loadData,e.onNodeLoad,d,x,o]);var se=t.useMemo(function(){var n;return(n=e.draggable)!==null&&n!==void 0&&n.icon?t.createElement("span",{className:"".concat(e.prefixCls,"-draggable-icon")},e.draggable.icon):null},[e.draggable]),z=function(n){var r=o.switcherIcon||e.switcherIcon;return typeof r=="function"?r(A(A({},o),{},{isLeaf:n})):r},pe=t.useMemo(function(){if(!N)return null;var n=typeof N!="boolean"?N:null;return t.createElement("span",{className:u("".concat(e.prefixCls,"-checkbox"),a(a(a({},"".concat(e.prefixCls,"-checkbox-checked"),f),"".concat(e.prefixCls,"-checkbox-indeterminate"),!f&&h),"".concat(e.prefixCls,"-checkbox-disabled"),c||o.disableCheckbox)),onClick:R,role:"checkbox","aria-checked":h?"mixed":f,"aria-disabled":c||o.disableCheckbox,"aria-label":"Select ".concat(typeof o.title=="string"?o.title:"tree node")},n)},[N,f,h,c,o.disableCheckbox,o.title]),D=t.useMemo(function(){return x?null:d?J:Q},[x,d]),O=t.useMemo(function(){return t.createElement("span",{className:u("".concat(e.prefixCls,"-iconEle"),"".concat(e.prefixCls,"-icon__").concat(D||"docu"),a({},"".concat(e.prefixCls,"-icon_loading"),s))})},[e.prefixCls,D,s]),ue=t.useMemo(function(){var n=!!e.draggable;return!o.disabled&&n&&e.dragOverNodeKey===l?e.dropIndicatorRender({dropPosition:e.dropPosition,dropLevelOffset:e.dropLevelOffset,indent:e.indent,prefixCls:e.prefixCls,direction:e.direction}):null},[e.dropPosition,e.dropLevelOffset,e.indent,e.prefixCls,e.direction,e.draggable,e.dragOverNodeKey,e.dropIndicatorRender]),fe=t.useMemo(function(){var n,r,V=o.title,m=V===void 0?"---":V,j="".concat(e.prefixCls,"-node-content-wrapper");if(e.showIcon){var E=o.icon||e.icon;n=E?t.createElement("span",{className:u("".concat(e.prefixCls,"-iconEle"),"".concat(e.prefixCls,"-icon__customize"))},typeof E=="function"?E(o):E):O}else e.loadData&&s&&(n=O);return r=typeof m=="function"?m(v):e.titleRender?e.titleRender(v):m,t.createElement("span",{ref:re,title:typeof m=="string"?m:"",className:u(j,"".concat(j,"-").concat(D||"normal"),a({},"".concat(e.prefixCls,"-node-selected"),!c&&(q||ie))),onMouseEnter:_,onMouseLeave:B,onContextMenu:G,onClick:I,onDoubleClick:K},n,t.createElement("span",{className:"".concat(e.prefixCls,"-title")},r),ue)},[e.prefixCls,e.showIcon,o,e.icon,O,e.titleRender,v,D,_,B,G,I,K]),ve=Ee(ae,{aria:!0,data:!0}),xe=(H(e.keyEntities,l)||{}).level,Ce=P[P.length-1],U=!c&&p,be=e.draggingNodeKey===l,Ne=b!==void 0?{"aria-selected":!!b}:void 0;return t.createElement("div",me({ref:oe,role:"treeitem","aria-expanded":C?void 0:d,className:u(W,"".concat(e.prefixCls,"-treenode"),(y={},a(a(a(a(a(a(a(a(a(a(y,"".concat(e.prefixCls,"-treenode-disabled"),c),"".concat(e.prefixCls,"-treenode-switcher-").concat(d?"open":"close"),!C),"".concat(e.prefixCls,"-treenode-checkbox-checked"),f),"".concat(e.prefixCls,"-treenode-checkbox-indeterminate"),h),"".concat(e.prefixCls,"-treenode-selected"),q),"".concat(e.prefixCls,"-treenode-loading"),s),"".concat(e.prefixCls,"-treenode-active"),ne),"".concat(e.prefixCls,"-treenode-leaf-last"),Ce),"".concat(e.prefixCls,"-treenode-draggable"),p),"dragging",be),a(a(a(a(a(a(a(y,"drop-target",e.dropTargetKey===l),"drop-container",e.dropContainerKey===l),"drag-over",!c&&Y),"drag-over-gap-top",!c&&Z),"drag-over-gap-bottom",!c&&$),"filter-node",(M=e.filterTreeNode)===null||M===void 0?void 0:M.call(e,i.convertNodePropsToEventData(o))),"".concat(e.prefixCls,"-treenode-leaf"),x))),style:X,draggable:U,onDragStart:U?function(n){n.stopPropagation(),T(!0),e.onNodeDragStart(n,o);try{n.dataTransfer.setData("text/plain","")}catch{}}:void 0,onDragEnter:p?function(n){n.preventDefault(),n.stopPropagation(),e.onNodeDragEnter(n,o)}:void 0,onDragOver:p?function(n){n.preventDefault(),n.stopPropagation(),e.onNodeDragOver(n,o)}:void 0,onDragLeave:p?function(n){n.stopPropagation(),e.onNodeDragLeave(n,o)}:void 0,onDrop:p?function(n){n.preventDefault(),n.stopPropagation(),T(!1),e.onNodeDrop(n,o)}:void 0,onDragEnd:p?function(n){n.stopPropagation(),T(!1),e.onNodeDragEnd(n,o)}:void 0,onMouseMove:te},Ne,ve),t.createElement(ke,{prefixCls:e.prefixCls,level:xe,isStart:ee,isEnd:P}),se,function(){if(x){var n=z(!0);return n!==!1?t.createElement("span",{className:u("".concat(e.prefixCls,"-switcher"),"".concat(e.prefixCls,"-switcher-noop"))},n):null}var r=z(!1);return r!==!1?t.createElement("span",{onClick:de,className:u("".concat(e.prefixCls,"-switcher"),"".concat(e.prefixCls,"-switcher_").concat(d?J:Q))},r):null}(),pe,fe)};L.isTreeNode=1,process.env.NODE_ENV!=="production"&&(L.displayName="TreeNode"),module.exports=L;

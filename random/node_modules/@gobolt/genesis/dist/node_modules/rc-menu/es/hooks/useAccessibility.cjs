"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const c=require("../../../@babel/runtime/helpers/esm/defineProperty.cjs"),ie=require("../../../rc-util/es/Dom/focus.cjs"),g=require("../../../rc-util/es/KeyCode.cjs"),B=require("../../../rc-util/es/raf.cjs"),le=require("react"),ce=require("../context/IdContext.cjs");function ae(e){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const u in e)if(u!=="default"){const a=Object.getOwnPropertyDescriptor(e,u);Object.defineProperty(l,u,a.get?a:{enumerable:!0,get:()=>e[u]})}}return l.default=e,Object.freeze(l)}const G=ae(le);var M=g.LEFT,U=g.RIGHT,W=g.UP,O=g.DOWN,q=g.ENTER,ee=g.ESC,p=g.HOME,S=g.END,te=[W,O,M,U];function _(e,l){return ie.getFocusNodeList(e,!0).filter(function(u){return l.has(u)})}function ne(e,l,u){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;if(!e)return null;var s=_(e,l),f=s.length,t=s.findIndex(function(T){return u===T});return a<0?t===-1?t=f-1:t-=1:a>0&&(t+=1),s[t=(t+f)%f]}var I=function(e,l){var u=new Set,a=new Map,s=new Map;return e.forEach(function(f){var t=document.querySelector("[data-menu-id='".concat(ce.getMenuId(l,f),"']"));t&&(u.add(t),s.set(t,f),a.set(f,t))}),{elements:u,key2element:a,element2key:s}};exports.getFocusableElements=_,exports.refreshElements=I,exports.useAccessibility=function(e,l,u,a,s,f,t,T,w,C){var N=G.useRef(),J=G.useRef();J.current=l;var x=function(){B.cancel(N.current)};return G.useEffect(function(){return function(){x()}},[]),function(F){var o=F.which;if([].concat(te,[q,ee,p,S]).includes(o)){var K=f(),k=I(K,a),A=k,D=A.elements,Q=A.key2element,V=A.element2key,v=function(i,n){for(var r=i||document.activeElement;r;){if(n.has(r))return r;r=r.parentElement}return null}(Q.get(l),D),y=V.get(v),d=function(i,n,r,b){var H,h="prev",E="next",m="children",j="parent";if(i==="inline"&&b===q)return{inlineTrigger:!0};var P=c(c({},W,h),O,E),ue=c(c(c(c({},M,r?E:h),U,r?h:E),O,m),q,m),L=c(c(c(c(c(c({},W,h),O,E),q,m),ee,j),M,r?m:j),U,r?j:m);switch((H={inline:P,horizontal:ue,vertical:L,inlineSub:P,horizontalSub:L,verticalSub:L}["".concat(i).concat(n?"":"Sub")])===null||H===void 0?void 0:H[b]){case h:return{offset:-1,sibling:!0};case E:return{offset:1,sibling:!0};case j:return{offset:-1,sibling:!1};case m:return{offset:1,sibling:!1};default:return null}}(e,t(y,!0).length===1,u,o);if(!d&&o!==p&&o!==S)return;(te.includes(o)||[p,S].includes(o))&&F.preventDefault();var R=function(i){if(i){var n=i,r=i.querySelector("a");r!=null&&r.getAttribute("href")&&(n=r);var b=V.get(i);T(b),x(),N.current=B(function(){J.current===b&&n.focus()})}};if([p,S].includes(o)||d.sibling||!v){var X,Y,z=_(X=v&&e!=="inline"?function(i){for(var n=i;n;){if(n.getAttribute("data-menu-list"))return n;n=n.parentElement}return null}(v):s.current,D);Y=o===p?z[0]:o===S?z[z.length-1]:ne(X,D,v,d.offset),R(Y)}else if(d.inlineTrigger)w(y);else if(d.offset>0)w(y,!0),x(),N.current=B(function(){k=I(K,a);var i=v.getAttribute("aria-controls"),n=ne(document.getElementById(i),k.elements);R(n)},5);else if(d.offset<0){var Z=t(y,!0),$=Z[Z.length-2],re=Q.get($);w($,!1),R(re)}}C==null||C(F)}};

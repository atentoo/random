"use strict";const I=require("../../../@babel/runtime/helpers/esm/extends.cjs"),M=require("../../../@babel/runtime/helpers/esm/slicedToArray.cjs"),u=require("../../../rc-util/es/KeyCode.cjs"),p=require("react"),k=require("../hooks/useLock.cjs"),H=require("../utils/keyUtil.cjs"),K=require("./MultipleSelector.cjs"),V=require("./SingleSelector.cjs");function W(e){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const o=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(s,r,o.get?o:{enumerable:!0,get:()=>e[r]})}}return s.default=e,Object.freeze(s)}const f=W(p);var A=function(e,s){var r=p.useRef(null),o=p.useRef(!1),d=e.prefixCls,l=e.open,c=e.mode,x=e.showSearch,y=e.tokenWithEnter,N=e.disabled,g=e.prefix,T=e.autoClearSearchValue,v=e.onSearch,b=e.onSearchSubmit,m=e.onToggleOpen,D=e.onInputKeyDown,q=e.onInputBlur,w=e.domRef;f.useImperativeHandle(s,function(){return{focus:function(t){r.current.focus(t)},blur:function(){r.current.blur()}}});var R=k(0),E=M(R,2),C=E[0],j=E[1],a=p.useRef(null),O=function(t){v(t,!0,o.current)!==!1&&m(!0)},h={inputRef:r,onInputKeyDown:function(t){var n=t.which,i=r.current instanceof HTMLTextAreaElement;i||!l||n!==u.UP&&n!==u.DOWN||t.preventDefault(),D&&D(t),n!==u.ENTER||c!=="tags"||o.current||l||b==null||b(t.target.value),i&&!l&&~[u.UP,u.DOWN,u.LEFT,u.RIGHT].indexOf(n)||H.isValidateOpenKey(n)&&m(!0)},onInputMouseDown:function(){j(!0)},onInputChange:function(t){var n=t.target.value;if(y&&a.current&&/[\r\n]/.test(a.current)){var i=a.current.replace(/[\r\n]+$/,"").replace(/\r\n/g," ").replace(/[\r\n]/g," ");n=n.replace(i,a.current)}a.current=null,O(n)},onInputPaste:function(t){var n=t.clipboardData,i=n==null?void 0:n.getData("text");a.current=i||""},onInputCompositionStart:function(){o.current=!0},onInputCompositionEnd:function(t){o.current=!1,c!=="combobox"&&O(t.target.value)},onInputBlur:q},P=c==="multiple"||c==="tags"?f.createElement(K,I({},e,h)):f.createElement(V,I({},e,h));return f.createElement("div",{ref:w,className:"".concat(d,"-selector"),onClick:function(t){t.target!==r.current&&(document.body.style.msTouchAction!==void 0?setTimeout(function(){r.current.focus()}):r.current.focus())},onMouseDown:function(t){var n=C();t.target===r.current||n||c==="combobox"&&N||t.preventDefault(),(c==="combobox"||x&&n)&&l||(l&&T!==!1&&v("",!0,!1),m())}},g&&f.createElement("div",{className:"".concat(d,"-prefix")},g),P)},S=f.forwardRef(A);process.env.NODE_ENV!=="production"&&(S.displayName="Selector"),module.exports=S;

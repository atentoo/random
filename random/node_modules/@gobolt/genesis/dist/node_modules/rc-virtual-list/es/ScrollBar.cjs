"use strict";const h=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),w=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),b=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),W=require("../../../_virtual/index.cjs"),j=require("../../rc-util/es/raf.cjs"),me=require("react"),Z=require("./hooks/useScrollDrag.cjs");function he(e){const l=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const c in e)if(c!=="default"){const p=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(l,c,p.get?p:{enumerable:!0,get:()=>e[c]})}}return l.default=e,Object.freeze(l)}const t=he(me);var $=t.forwardRef(function(e,l){var c=e.prefixCls,p=e.rtl,g=e.scrollOffset,U=e.scrollRange,ee=e.onStartMove,te=e.onStopMove,re=e.onScroll,o=e.horizontal,E=e.spinSize,S=e.containerSize,ne=e.style,oe=e.thumbStyle,L=e.showScrollBar,ae=t.useState(!1),x=b(ae,2),f=x[0],B=x[1],ie=t.useState(null),H=b(ie,2),M=H[0],ue=H[1],ce=t.useState(null),C=b(ce,2),X=C[0],se=C[1],y=!p,R=t.useRef(),_=t.useRef(),le=t.useState(L),k=b(le,2),I=k[0],V=k[1],D=t.useRef(),T=function(){L!==!0&&L!==!1&&(clearTimeout(D.current),V(!0),D.current=setTimeout(function(){V(!1)},3e3))},m=U-S||0,q=S-E||0,v=t.useMemo(function(){return g===0||m===0?0:g/m*q},[g,m,q]),O=t.useRef({top:v,dragging:f,pageY:M,startTop:X});O.current={top:v,dragging:f,pageY:M,startTop:X};var N=function(r){B(!0),ue(Z.getPageXY(r,o)),se(O.current.top),ee(),r.stopPropagation(),r.preventDefault()};t.useEffect(function(){var r=function(P){P.preventDefault()},i=R.current,u=_.current;return i.addEventListener("touchstart",r,{passive:!1}),u.addEventListener("touchstart",N,{passive:!1}),function(){i.removeEventListener("touchstart",r),u.removeEventListener("touchstart",N)}},[]);var A=t.useRef();A.current=m;var F=t.useRef();F.current=q,t.useEffect(function(){if(f){var r,i=function(P){var z=O.current,fe=z.dragging,ve=z.pageY,de=z.startTop;j.cancel(r);var G=R.current.getBoundingClientRect(),pe=S/(o?G.width:G.height);if(fe){var J=(Z.getPageXY(P,o)-ve)*pe,Y=de;!y&&o?Y-=J:Y+=J;var K=A.current,Q=F.current,ge=Q?Y/Q:0,d=Math.ceil(ge*K);d=Math.max(d,0),d=Math.min(d,K),r=j(function(){re(d,o)})}},u=function(){B(!1),te()};return window.addEventListener("mousemove",i,{passive:!0}),window.addEventListener("touchmove",i,{passive:!0}),window.addEventListener("mouseup",u,{passive:!0}),window.addEventListener("touchend",u,{passive:!0}),function(){window.removeEventListener("mousemove",i),window.removeEventListener("touchmove",i),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u),j.cancel(r)}}},[f]),t.useEffect(function(){return T(),function(){clearTimeout(D.current)}},[g]),t.useImperativeHandle(l,function(){return{delayHidden:T}});var s="".concat(c,"-scrollbar"),n={position:"absolute",visibility:I?null:"hidden"},a={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return o?(n.height=8,n.left=0,n.right=0,n.bottom=0,a.height="100%",a.width=E,y?a.left=v:a.right=v):(n.width=8,n.top=0,n.bottom=0,y?n.right=0:n.left=0,a.width="100%",a.height=E,a.top=v),t.createElement("div",{ref:R,className:W(s,w(w(w({},"".concat(s,"-horizontal"),o),"".concat(s,"-vertical"),!o),"".concat(s,"-visible"),I)),style:h(h({},n),ne),onMouseDown:function(r){r.stopPropagation(),r.preventDefault()},onMouseMove:T},t.createElement("div",{ref:_,className:W("".concat(s,"-thumb"),w({},"".concat(s,"-thumb-moving"),f)),style:h(h({},a),oe),onMouseDown:N}))});process.env.NODE_ENV!=="production"&&($.displayName="ScrollBar"),module.exports=$;

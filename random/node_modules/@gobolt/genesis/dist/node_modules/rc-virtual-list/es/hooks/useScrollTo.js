import B from "../../../@babel/runtime/helpers/esm/typeof.js";
import h from "../../../@babel/runtime/helpers/esm/objectSpread2.js";
import C from "../../../@babel/runtime/helpers/esm/slicedToArray.js";
import * as O from "react";
import F from "../../../rc-util/es/raf.js";
import G from "../../../rc-util/es/hooks/useLayoutEffect.js";
import "../../../rc-util/es/ref.js";
import { warningOnce as H } from "../../../rc-util/es/warning.js";
function W(n, f, x, y, s, D, T, M) {
  var P = O.useRef(), R = O.useState(null), b = C(R, 2), t = b[0], u = b[1];
  return G(function() {
    if (t && t.times < 10) {
      if (!n.current) return void u(function(z) {
        return h({}, z);
      });
      D();
      var e = t.targetAlign, a = t.originAlign, m = t.index, i = t.offset, r = n.current.clientHeight, c = !1, p = e, o = null;
      if (r) {
        for (var k = e || a, S = 0, l = 0, v = 0, j = Math.min(f.length - 1, m), g = 0; g <= j; g += 1) {
          var V = s(f[g]);
          l = S;
          var w = x.get(V);
          S = v = l + (w === void 0 ? y : w);
        }
        for (var _ = k === "top" ? i : r - i, d = j; d >= 0; d -= 1) {
          var q = s(f[d]), A = x.get(q);
          if (A === void 0) {
            c = !0;
            break;
          }
          if ((_ -= A) <= 0) break;
        }
        switch (k) {
          case "top":
            o = l - i;
            break;
          case "bottom":
            o = v - r + i;
            break;
          default:
            var E = n.current.scrollTop;
            l < E ? p = "top" : v > E + r && (p = "bottom");
        }
        o !== null && T(o), o !== t.lastTop && (c = !0);
      }
      c && u(h(h({}, t), {}, { times: t.times + 1, targetAlign: p, lastTop: o }));
    } else process.env.NODE_ENV !== "production" && (t == null ? void 0 : t.times) === 10 && H(!1, "Seems `scrollTo` with `rc-virtual-list` reach the max limitation. Please fire issue for us. Thanks.");
  }, [t, n.current]), function(e) {
    if (e != null) {
      if (F.cancel(P.current), typeof e == "number") T(e);
      else if (e && B(e) === "object") {
        var a, m = e.align;
        a = "index" in e ? e.index : f.findIndex(function(r) {
          return s(r) === e.key;
        });
        var i = e.offset;
        u({ times: 0, index: a, offset: i === void 0 ? 0 : i, originAlign: m });
      }
    } else M();
  };
}
export {
  W as default
};

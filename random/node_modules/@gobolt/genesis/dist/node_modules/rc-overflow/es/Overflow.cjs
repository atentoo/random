"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const I=require("../../@babel/runtime/helpers/esm/extends.cjs"),M=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),a=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),Fe=require("../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),s=require("react"),Ge=require("../../../_virtual/index.cjs"),Xe=require("../../rc-resize-observer/es/index.cjs"),Be=require("../../rc-util/es/hooks/useLayoutEffect.cjs"),W=require("./Item.cjs"),p=require("./hooks/useEffectState.cjs"),Le=require("./RawItem.cjs"),K=require("./context.cjs");function He(r){const y=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(r){for(const f in r)if(f!=="default"){const g=Object.getOwnPropertyDescriptor(r,f);Object.defineProperty(y,f,g.get?g:{enumerable:!0,get:()=>r[f]})}}return y.default=r,Object.freeze(y)}const u=He(s);var Je=["prefixCls","data","renderItem","renderRawItem","itemKey","itemWidth","ssr","style","className","maxCount","renderRest","renderRawRest","suffix","component","itemComponent","onVisibleChange"],me="responsive",ce="invalidate";function Qe(r){return"+ ".concat(r.length," ...")}function Ue(r,y){var f=r.prefixCls,g=f===void 0?"rc-overflow":f,V=r.data,i=V===void 0?[]:V,F=r.renderItem,G=r.renderRawItem,b=r.itemKey,X=r.itemWidth,B=X===void 0?10:X,ve=r.ssr,pe=r.style,ye=r.className,d=r.maxCount,ge=r.renderRest,L=r.renderRawRest,k=r.suffix,H=r.component,be=H===void 0?"div":H,he=r.itemComponent,J=r.onVisibleChange,Ce=Fe(r,Je),z=ve==="full",h=p.useBatcher(),Ee=p.default(h,null),Q=a(Ee,2),w=Q[0],Se=Q[1],m=w||0,we=p.default(h,new Map),U=a(we,2),Y=U[0],Re=U[1],xe=p.default(h,0),Z=a(xe,2),Ne=Z[0],Oe=Z[1],qe=p.default(h,0),$=a(qe,2),R=$[0],Ie=$[1],Me=p.default(h,0),ee=a(Me,2),x=ee[0],ke=ee[1],ze=s.useState(null),te=a(ze,2),_=te[0],re=te[1],_e=s.useState(null),ne=a(_e,2),N=ne[0],Ae=ne[1],v=u.useMemo(function(){return N===null&&z?Number.MAX_SAFE_INTEGER:N||0},[N,w]),je=s.useState(!1),ie=a(je,2),De=ie[0],Pe=ie[1],A="".concat(g,"-item"),le=Math.max(Ne,R),j=d===me,o=i.length&&j,oe=d===ce,Te=o||typeof d=="number"&&i.length>d,c=s.useMemo(function(){var e=i;return o?e=w===null&&z?i:i.slice(0,Math.min(i.length,m/B)):typeof d=="number"&&(e=i.slice(0,d)),e},[i,B,w,d,o]),D=s.useMemo(function(){return o?i.slice(v+1):i.slice(c.length)},[i,c,o,v]),O=s.useCallback(function(e,t){var n;return typeof b=="function"?b(e):(n=b&&(e==null?void 0:e[b]))!==null&&n!==void 0?n:t},[b]),We=s.useCallback(F||function(e){return e},[F]);function q(e,t,n){(N!==e||t!==void 0&&t!==_)&&(Ae(e),n||(Pe(e<i.length-1),J==null||J(e)),t!==void 0&&re(t))}function ue(e,t){Re(function(n){var l=new Map(n);return t===null?l.delete(e):l.set(e,t),l})}function P(e){return Y.get(O(c[e],e))}Be.default(function(){if(m&&typeof le=="number"&&c){var e=x,t=c.length,n=t-1;if(!t)return void q(0,null);for(var l=0;l<t;l+=1){var E=P(l);if(z&&(E=E||0),E===void 0){q(l-1,void 0,!0);break}if(e+=E,n===0&&e<=m||l===n-1&&e+P(n)<=m){q(n,null);break}if(e+le>m){q(l-1,e-E-x+R);break}}k&&P(0)+x>m&&re(null)}},[m,Y,R,x,O,c]);var ae=De&&!!D.length,se={};_!==null&&o&&(se={position:"absolute",left:_,top:0});var C={prefixCls:A,responsive:o,component:he,invalidate:oe},Ke=G?function(e,t){var n=O(e,t);return u.createElement(K.OverflowContext.Provider,{key:n,value:M(M({},C),{},{order:t,item:e,itemKey:n,registerSize:ue,display:t<=v})},G(e,t))}:function(e,t){var n=O(e,t);return u.createElement(W,I({},C,{order:t,key:n,item:e,renderItem:We,itemKey:n,registerSize:ue,display:t<=v}))},fe={order:ae?v:Number.MAX_SAFE_INTEGER,className:"".concat(A,"-rest"),registerSize:function(e,t){Ie(t),Oe(R)},display:ae},T=ge||Qe,Ve=L?u.createElement(K.OverflowContext.Provider,{value:M(M({},C),fe)},L(D)):u.createElement(W,I({},C,fe),typeof T=="function"?T(D):T),de=u.createElement(be,I({className:Ge(!oe&&g,ye),style:pe,ref:y},Ce),c.map(Ke),Te?Ve:null,k&&u.createElement(W,I({},C,{responsive:j,responsiveDisabled:!o,order:v,className:"".concat(A,"-suffix"),registerSize:function(e,t){ke(t)},display:!0,style:se}),k));return j?u.createElement(Xe,{onResize:function(e,t){Se(t.clientWidth)},disabled:!o},de):de}var S=u.forwardRef(Ue);S.displayName="Overflow",S.Item=Le,S.RESPONSIVE=me,S.INVALIDATE=ce,exports.OverflowContext=K.OverflowContext,exports.default=S;

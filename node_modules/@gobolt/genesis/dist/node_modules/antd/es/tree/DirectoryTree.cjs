"use strict";const D=require("../../../@babel/runtime/helpers/esm/toConsumableArray.cjs"),M=require("react"),V=require("../../../@ant-design/icons/es/icons/FileOutlined.cjs"),B=require("../../../@ant-design/icons/es/icons/FolderOpenOutlined.cjs"),F=require("../../../@ant-design/icons/es/icons/FolderOutlined.cjs"),G=require("../../../../_virtual/index.cjs"),H=require("../../../rc-tree/es/util.cjs"),T=require("../../../rc-tree/es/utils/treeUtil.cjs");require("../config-provider/index.cjs");const J=require("./Tree.cjs"),K=require("./utils/dictUtil.cjs"),Q=require("../config-provider/context.cjs");function U(t){const c=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(c,r,n.get?n:{enumerable:!0,get:()=>t[r]})}}return c.default=t,Object.freeze(c)}const o=U(M);var j=function(t,c){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&c.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function"){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)c.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]])}return r};function W(t){const{isLeaf:c,expanded:r}=t;return c?o.createElement(V,null):r?o.createElement(B,null):o.createElement(F,null)}function q(t){let{treeData:c,children:r}=t;return c||T.convertTreeToData(r)}const X=(t,c)=>{var{defaultExpandAll:r,defaultExpandParent:n,defaultExpandedKeys:s}=t,e=j(t,["defaultExpandAll","defaultExpandParent","defaultExpandedKeys"]);const v=o.useRef(null),E=o.useRef(null),[w,O]=o.useState(e.selectedKeys||e.defaultSelectedKeys||[]),[b,g]=o.useState(()=>(()=>{const{keyEntities:a}=T.convertDataToEntities(q(e));let d;return d=r?Object.keys(a):n?H.conductExpandParent(e.expandedKeys||s||[],a):e.expandedKeys||s||[],d})());o.useEffect(()=>{"selectedKeys"in e&&O(e.selectedKeys)},[e.selectedKeys]),o.useEffect(()=>{"expandedKeys"in e&&g(e.expandedKeys)},[e.expandedKeys]);const{getPrefixCls:P,direction:h}=o.useContext(Q.ConfigContext),{prefixCls:C,className:A,showIcon:k=!0,expandAction:I="click"}=e,R=j(e,["prefixCls","className","showIcon","expandAction"]),m=P("tree",C),_=G(`${m}-directory`,{[`${m}-directory-rtl`]:h==="rtl"},A);return o.createElement(J,Object.assign({icon:W,ref:c,blockNode:!0},R,{showIcon:k,expandAction:I,prefixCls:m,className:_,expandedKeys:b,selectedKeys:w,onSelect:(a,d)=>{var i;const{multiple:N,fieldNames:y}=e,{node:$,nativeEvent:u}=d,{key:p=""}=$,f=q(e),x=Object.assign(Object.assign({},d),{selected:!0}),z=(u==null?void 0:u.ctrlKey)||(u==null?void 0:u.metaKey),L=u==null?void 0:u.shiftKey;let l;N&&z?(l=a,v.current=p,E.current=l,x.selectedNodes=K.convertDirectoryKeysToNodes(f,l,y)):N&&L?(l=Array.from(new Set([].concat(D(E.current||[]),D(K.calcRangeKeys({treeData:f,expandedKeys:b,startKey:p,endKey:v.current,fieldNames:y}))))),x.selectedNodes=K.convertDirectoryKeysToNodes(f,l,y)):(l=[p],v.current=p,E.current=l,x.selectedNodes=K.convertDirectoryKeysToNodes(f,l,y)),(i=e.onSelect)===null||i===void 0||i.call(e,l,x),"selectedKeys"in e||O(l)},onExpand:(a,d)=>{var i;return"expandedKeys"in e||g(a),(i=e.onExpand)===null||i===void 0?void 0:i.call(e,a,d)}}))},S=o.forwardRef(X);process.env.NODE_ENV!=="production"&&(S.displayName="DirectoryTree"),module.exports=S;

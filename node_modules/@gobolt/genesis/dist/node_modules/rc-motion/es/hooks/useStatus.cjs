"use strict";const le=require("../../../@babel/runtime/helpers/esm/objectSpread2.cjs"),T=require("../../../@babel/runtime/helpers/esm/defineProperty.cjs"),l=require("../../../@babel/runtime/helpers/esm/slicedToArray.cjs"),_e=require("../../../rc-util/es/hooks/useEvent.cjs");require("../../../rc-util/es/hooks/useLayoutEffect.cjs");const J=require("../../../rc-util/es/hooks/useState.cjs");require("../../../rc-util/es/ref.cjs"),require("../../../rc-util/es/warning.cjs");const ve=require("../../../rc-util/es/hooks/useSyncState.cjs"),S=require("react"),e=require("../interface.cjs"),Re=require("./useDomMotionEvents.cjs"),se=require("./useIsomorphicLayoutEffect.cjs"),f=require("./useStepQueue.cjs");function de(o){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const A in o)if(A!=="default"){const r=Object.getOwnPropertyDescriptor(o,A);Object.defineProperty(t,A,r.get?r:{enumerable:!0,get:()=>o[A]})}}return t.default=o,Object.freeze(t)}const K=de(S);module.exports=function(o,t,A,r){var L=r.motionEnter,N=L===void 0||L,g=r.motionAppear,U=g===void 0||g,V=r.motionLeave,_=V===void 0||V,b=r.motionDeadline,Q=r.motionLeaveImmediately,W=r.onAppearPrepare,X=r.onEnterPrepare,Y=r.onLeavePrepare,Z=r.onAppearStart,$=r.onEnterStart,ee=r.onLeaveStart,re=r.onAppearActive,ne=r.onEnterActive,te=r.onLeaveActive,D=r.onAppearEnd,C=r.onEnterEnd,I=r.onLeaveEnd,j=r.onVisibleChanged,ue=J(),y=l(ue,2),a=y[0],Ee=y[1],ie=ve(e.STATUS_NONE),M=l(ie,2),h=M[0],v=M[1],Te=J(null),w=l(Te,2),oe=w[0],k=w[1],E=h(),R=S.useRef(!1),m=S.useRef(null);function s(){return A()}var x=S.useRef(!1);function z(){v(e.STATUS_NONE),k(null,!0)}var H=_e(function(n){var u=h();if(u!==e.STATUS_NONE){var i=s();if(!n||n.deadline||n.target===i){var d,p=x.current;u===e.STATUS_APPEAR&&p?d=D==null?void 0:D(i,n):u===e.STATUS_ENTER&&p?d=C==null?void 0:C(i,n):u===e.STATUS_LEAVE&&p&&(d=I==null?void 0:I(i,n)),p&&d!==!1&&z()}}}),Se=Re(H),ae=l(Se,1)[0],B=function(n){switch(n){case e.STATUS_APPEAR:return T(T(T({},e.STEP_PREPARE,W),e.STEP_START,Z),e.STEP_ACTIVE,re);case e.STATUS_ENTER:return T(T(T({},e.STEP_PREPARE,X),e.STEP_START,$),e.STEP_ACTIVE,ne);case e.STATUS_LEAVE:return T(T(T({},e.STEP_PREPARE,Y),e.STEP_START,ee),e.STEP_ACTIVE,te);default:return{}}},P=K.useMemo(function(){return B(E)},[E]),ce=f.default(E,!o,function(n){if(n===e.STEP_PREPARE){var u=P[e.STEP_PREPARE];return u?u(s()):f.SkipStep}var i;return c in P&&k(((i=P[c])===null||i===void 0?void 0:i.call(P,s(),null))||null),c===e.STEP_ACTIVE&&E!==e.STATUS_NONE&&(ae(s()),b>0&&(clearTimeout(m.current),m.current=setTimeout(function(){H({deadline:!0})},b))),c===e.STEP_PREPARED&&z(),f.DoStep}),F=l(ce,2),Ae=F[0],c=F[1],Pe=f.isActive(c);x.current=Pe;var G=S.useRef(null);se(function(){if(!R.current||G.current!==t){Ee(t);var n,u=R.current;R.current=!0,!u&&t&&U&&(n=e.STATUS_APPEAR),u&&t&&N&&(n=e.STATUS_ENTER),(u&&!t&&_||!u&&Q&&!t&&_)&&(n=e.STATUS_LEAVE);var i=B(n);n&&(o||i[e.STEP_PREPARE])?(v(n),Ae()):v(e.STATUS_NONE),G.current=t}},[t]),S.useEffect(function(){(E===e.STATUS_APPEAR&&!U||E===e.STATUS_ENTER&&!N||E===e.STATUS_LEAVE&&!_)&&v(e.STATUS_NONE)},[U,N,_]),S.useEffect(function(){return function(){R.current=!1,clearTimeout(m.current)}},[]);var q=K.useRef(!1);S.useEffect(function(){a&&(q.current=!0),a!==void 0&&E===e.STATUS_NONE&&((q.current||a)&&(j==null||j(a)),q.current=!0)},[a,E]);var O=oe;return P[e.STEP_PREPARE]&&c===e.STEP_START&&(O=le({transition:"none"},O)),[E,c,O,a??t]};

"use strict";const P=require("../../@babel/runtime/helpers/esm/defineProperty.cjs"),a=require("../../@babel/runtime/helpers/esm/objectSpread2.cjs"),M=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),V=require("../../@rc-component/context/es/context.cjs");require("../../rc-util/es/ref.cjs");const I=require("react"),U=require("../../../_virtual/index.cjs"),O=require("../../rc-util/es/Dom/addEventListener.cjs"),k=require("../../rc-util/es/getScrollBarSize.cjs"),_=require("./context/TableContext.cjs"),A=require("./hooks/useFrame.cjs"),y=require("../../rc-util/es/raf.cjs"),D=require("./utils/offsetUtil.cjs"),F=require("../../rc-util/es/Dom/findDOMNode.cjs");function G(n){const p=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(n){for(const i in n)if(i!=="default"){const f=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(p,i,f.get?f:{enumerable:!0,get:()=>n[i]})}}return p.default=n,Object.freeze(p)}const t=G(I);var J=function(n,p){var i,f,l=n.scrollBodyRef,R=n.onScroll,x=n.offsetScroll,d=n.container,j=n.direction,S=V.useContext(_.default,"prefixCls"),h=((i=l.current)===null||i===void 0?void 0:i.scrollWidth)||0,c=((f=l.current)===null||f===void 0?void 0:f.clientWidth)||0,v=h&&c*(c/h),z=t.useRef(),N=A.useLayoutState({scrollLeft:0,isHiddenScrollBar:!0}),B=M(N,2),w=B[0],E=B[1],m=t.useRef({delta:0,x:0}),W=t.useState(!1),H=M(W,2),L=H[0],b=H[1],g=t.useRef(null);t.useEffect(function(){return function(){y.cancel(g.current)}},[]);var T=function(){b(!1)},X=function(e){var r,u=(e||((r=window)===null||r===void 0?void 0:r.event)).buttons;if(L&&u!==0){var s=m.current.x+e.pageX-m.current.x-m.current.delta,q=j==="rtl";s=Math.max(q?v-c:0,Math.min(q?0:c-v,s)),(!q||Math.abs(s)+Math.abs(v)<c)&&(R({scrollLeft:s/c*(h+2)}),m.current.x=e.pageX)}else L&&b(!1)},o=function(){y.cancel(g.current),g.current=y(function(){if(l.current){var e=D.getOffset(l.current).top,r=e+l.current.offsetHeight,u=d===window?document.documentElement.scrollTop+window.innerHeight:D.getOffset(d).top+d.clientHeight;r-k.default()<=u||e>=u-x?E(function(s){return a(a({},s),{},{isHiddenScrollBar:!0})}):E(function(s){return a(a({},s),{},{isHiddenScrollBar:!1})})}})},C=function(e){E(function(r){return a(a({},r),{},{scrollLeft:e/h*c||0})})};return t.useImperativeHandle(p,function(){return{setScrollLeft:C,checkScrollBarVisible:o}}),t.useEffect(function(){var e=O(document.body,"mouseup",T,!1),r=O(document.body,"mousemove",X,!1);return o(),function(){e.remove(),r.remove()}},[v,L]),t.useEffect(function(){if(l.current){for(var e=[],r=F.getDOM(l.current);r;)e.push(r),r=r.parentElement;return e.forEach(function(u){return u.addEventListener("scroll",o,!1)}),window.addEventListener("resize",o,!1),window.addEventListener("scroll",o,!1),d.addEventListener("scroll",o,!1),function(){e.forEach(function(u){return u.removeEventListener("scroll",o)}),window.removeEventListener("resize",o),window.removeEventListener("scroll",o),d.removeEventListener("scroll",o)}}},[d]),t.useEffect(function(){w.isHiddenScrollBar||E(function(e){var r=l.current;return r?a(a({},e),{},{scrollLeft:r.scrollLeft/r.scrollWidth*r.clientWidth}):e})},[w.isHiddenScrollBar]),h<=c||!v||w.isHiddenScrollBar?null:t.createElement("div",{style:{height:k.default(),width:c,bottom:x},className:"".concat(S,"-sticky-scroll")},t.createElement("div",{onMouseDown:function(e){e.persist(),m.current.delta=e.pageX-w.scrollLeft,m.current.x=0,b(!0),e.preventDefault()},ref:z,className:U("".concat(S,"-sticky-scroll-bar"),P({},"".concat(S,"-sticky-scroll-bar-active"),L)),style:{width:"".concat(v,"px"),transform:"translate3d(".concat(w.scrollLeft,"px, 0, 0)")}}))};const K=t.forwardRef(J);module.exports=K;

import Me from "../../../@babel/runtime/helpers/esm/extends.js";
import be from "../../../@babel/runtime/helpers/esm/defineProperty.js";
import K from "../../../@babel/runtime/helpers/esm/objectSpread2.js";
import L from "../../../@babel/runtime/helpers/esm/toConsumableArray.js";
import u from "../../../@babel/runtime/helpers/esm/slicedToArray.js";
import He from "../../../../_virtual/index.js";
import Q from "../../../rc-util/es/hooks/useEvent.js";
import P from "../../../rc-util/es/hooks/useMergedState.js";
import "../../../rc-util/es/ref.js";
import { warningOnce as Se } from "../../../rc-util/es/warning.js";
import * as t from "react";
import Te from "../hooks/useLocale.js";
import { getTimeProps as Ae, fillShowTimeConfig as Oe } from "../hooks/useTimeConfig.js";
import ge from "../hooks/useToggleDates.js";
import qe from "../PickerInput/context.js";
import _e from "../PickerInput/hooks/useCellRender.js";
import { isSame as je } from "../utils/dateUtil.js";
import { toArray as We, pickProps as ze } from "../utils/miscUtil.js";
import { PickerHackContext as U } from "./context.js";
import X from "./DatePanel/index.js";
import Be from "./DateTimePanel/index.js";
import Fe from "./DecadePanel/index.js";
import Ge from "./MonthPanel/index.js";
import Je from "./QuarterPanel/index.js";
import Ke from "./TimePanel/index.js";
import Le from "./WeekPanel/index.js";
import Qe from "./YearPanel/index.js";
var Ue = { date: X, datetime: Be, week: Le, month: Ge, quarter: Je, year: Qe, decade: Fe, time: Ke };
function Xe(r, Y) {
  var s, v = r.locale, i = r.generateConfig, Z = r.direction, $ = r.prefixCls, x = r.tabIndex, ee = x === void 0 ? 0 : x, c = r.multiple, re = r.defaultValue, oe = r.value, h = r.onChange, w = r.onSelect, te = r.defaultPickerValue, k = r.pickerValue, E = r.onPickerValueChange, ne = r.mode, I = r.onPanelChange, N = r.picker, m = N === void 0 ? "date" : N, ae = r.showTime, ie = r.hoverValue, f = r.hoverRangeValue, me = r.cellRender, le = r.dateRender, ue = r.monthCellRender, R = r.components, ce = R === void 0 ? {} : R, y = r.hideHeader, D = ((s = t.useContext(qe)) === null || s === void 0 ? void 0 : s.prefixCls) || $ || "rc-picker", M = t.useRef();
  t.useImperativeHandle(Y, function() {
    return { nativeElement: M.current };
  });
  var fe = Ae(r), d = u(fe, 4), b = d[0], de = d[1], H = d[2], S = d[3], C = Te(v, de), p = m === "date" && ae ? "datetime" : m, T = t.useMemo(function() {
    return Oe(p, H, S, b, C);
  }, [p, H, S, b, C]), pe = i.getNow(), se = P(m, { value: ne, postState: function(e) {
    return e || "date";
  } }), A = u(se, 2), l = A[0], ve = A[1], O = l === "date" && T ? "datetime" : l, he = ge(i, v, p), ke = P(re, { value: oe }), g = u(ke, 2), q = g[0], Ce = g[1], n = t.useMemo(function() {
    var e = We(q).filter(function(o) {
      return o;
    });
    return c ? e : e.slice(0, 1);
  }, [q, c]), Ve = Q(function(e) {
    Ce(e), h && (e === null || n.length !== e.length || n.some(function(o, a) {
      return !je(i, v, o, e[a], p);
    })) && (h == null || h(c ? e : e[0]));
  }), Pe = Q(function(e) {
    if (w == null || w(e), l === m) {
      var o = c ? he(n, e) : [e];
      Ve(o);
    }
  }), xe = P(te || n[0] || pe, { value: k }), _ = u(xe, 2), we = _[0], j = _[1];
  t.useEffect(function() {
    n[0] && !k && j(n[0]);
  }, [n[0]]);
  var W = function(e, o) {
    I == null || I(e || k, o || l);
  }, V = function(e) {
    var o = arguments.length > 1 && arguments[1] !== void 0 && arguments[1];
    j(e), E == null || E(e), o && W(e);
  }, z = function(e, o) {
    ve(e), o && V(o), W(o, e);
  }, Ee = t.useMemo(function() {
    var e, o;
    if (Array.isArray(f)) {
      var a = u(f, 2);
      e = a[0], o = a[1];
    } else e = f;
    return e || o ? (e = e || o, o = o || e, i.isAfter(e, o) ? [o, e] : [e, o]) : null;
  }, [f, i]), Ie = _e(me, le, ue), Ne = ce[O] || Ue[O] || X, B = t.useContext(U), Re = t.useMemo(function() {
    return K(K({}, B), {}, { hideHeader: y });
  }, [B, y]);
  process.env.NODE_ENV !== "production" && Se(!n || n.every(function(e) {
    return i.isValidate(e);
  }), "Invalidate date pass to `value` or `defaultValue`.");
  var F = "".concat(D, "-panel"), ye = ze(r, ["showWeek", "prevIcon", "nextIcon", "superPrevIcon", "superNextIcon", "disabledDate", "minDate", "maxDate", "onHover"]);
  return t.createElement(U.Provider, { value: Re }, t.createElement("div", { ref: M, tabIndex: ee, className: He(F, be({}, "".concat(F, "-rtl"), Z === "rtl")) }, t.createElement(Ne, Me({}, ye, { showTime: T, prefixCls: D, locale: C, generateConfig: i, onModeChange: z, pickerValue: we, onPickerValueChange: function(e) {
    V(e, !0);
  }, value: n[0], onSelect: function(e) {
    if (Pe(e), V(e), l !== m) {
      var o = ["decade", "year"], a = [].concat(o, ["month"]), G = { quarter: [].concat(o, ["quarter"]), week: [].concat(L(a), ["week"]), date: [].concat(L(a), ["date"]) }[m] || a, De = G.indexOf(l), J = G[De + 1];
      J && z(J, e);
    }
  }, values: n, cellRender: Ie, hoverRangeValue: Ee, hoverValue: ie }))));
}
var Ye = t.memo(t.forwardRef(Xe));
process.env.NODE_ENV !== "production" && (Ye.displayName = "PanelPicker");
export {
  Ye as default
};

import k from "../../../../../@babel/runtime/helpers/esm/defineProperty.js";
import G from "../../../../../@babel/runtime/helpers/esm/toConsumableArray.js";
import H from "../../../../../@babel/runtime/helpers/esm/slicedToArray.js";
import L from "../../../../../../_virtual/index.js";
import O from "../../../../../rc-util/es/hooks/useLayoutEffect.js";
import * as i from "react";
import { usePanelContext as P } from "../../context.js";
import U from "./useScrollTo.js";
function V(e) {
  return e.map(function(t) {
    return [t.value, t.label, t.disabled].join(",");
  }).join(";");
}
function Y(e) {
  var t = e.units, c = e.value, y = e.optionalValue, C = e.type, T = e.onChange, E = e.onHover, h = e.onDblClick, x = e.changeOnScroll, u = P(), m = u.prefixCls, M = u.cellRender, S = u.now, g = u.locale, A = "".concat(m, "-time-panel"), f = "".concat(m, "-time-panel-cell"), s = i.useRef(null), N = i.useRef(), p = function() {
    clearTimeout(N.current);
  }, R = U(s, c ?? y), d = H(R, 3), j = d[0], D = d[1], _ = d[2];
  O(function() {
    return j(), p(), function() {
      D(), p();
    };
  }, [c, y, V(t)]);
  var q = "".concat(A, "-column");
  return i.createElement("ul", { className: q, ref: s, "data-type": C, onScroll: function(o) {
    p();
    var v = o.target;
    !_() && x && (N.current = setTimeout(function() {
      var n = s.current, r = n.querySelector("li").offsetTop, l = Array.from(n.querySelectorAll("li")).map(function(a) {
        return a.offsetTop - r;
      }).map(function(a, F) {
        return t[F].disabled ? Number.MAX_SAFE_INTEGER : Math.abs(a - v.scrollTop);
      }), I = Math.min.apply(Math, G(l)), w = l.findIndex(function(a) {
        return a === I;
      }), b = t[w];
      b && !b.disabled && T(b.value);
    }, 300));
  } }, t.map(function(o) {
    var v = o.label, n = o.value, r = o.disabled, l = i.createElement("div", { className: "".concat(f, "-inner") }, v);
    return i.createElement("li", { key: n, className: L(f, k(k({}, "".concat(f, "-selected"), c === n), "".concat(f, "-disabled"), r)), onClick: function() {
      r || T(n);
    }, onDoubleClick: function() {
      !r && h && h();
    }, onMouseEnter: function() {
      E(n);
    }, onMouseLeave: function() {
      E(null);
    }, "data-value": n }, M ? M(n, { prefixCls: m, originNode: l, today: S, type: "time", subType: C, locale: g }) : l);
  }));
}
export {
  Y as default
};

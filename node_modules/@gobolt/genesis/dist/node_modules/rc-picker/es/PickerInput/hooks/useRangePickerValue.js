import y from "../../../../@babel/runtime/helpers/esm/slicedToArray.js";
import * as M from "react";
import b from "../../../../rc-util/es/hooks/useMergedState.js";
import "../../../../rc-util/es/ref.js";
import "../../../../rc-util/es/warning.js";
import j from "../../../../rc-util/es/hooks/useLayoutEffect.js";
import { fillTime as C, isSame as P } from "../../utils/dateUtil.js";
function h(e, g, n, i) {
  switch (g) {
    case "date":
    case "week":
      return e.addMonth(n, i);
    case "month":
    case "quarter":
      return e.addYear(n, i);
    case "year":
      return e.addYear(n, 10 * i);
    case "decade":
      return e.addYear(n, 100 * i);
    default:
      return n;
  }
}
var V = [];
function W(e, g, n, i, s, L, a, p) {
  var m = arguments.length > 8 && arguments[8] !== void 0 ? arguments[8] : V, q = arguments.length > 10 && arguments[10] !== void 0 ? arguments[10] : V, A = arguments.length > 11 ? arguments[11] : void 0, k = arguments.length > 12 ? arguments[12] : void 0, f = arguments.length > 13 ? arguments[13] : void 0, v = a === "time", r = L || 0, D = function(t) {
    var o = e.getNow();
    return v && (o = C(e, o)), m[t] || n[t] || o;
  }, N = y(arguments.length > 9 && arguments[9] !== void 0 ? arguments[9] : V, 2), S = N[0], T = N[1], z = b(function() {
    return D(0);
  }, { value: S }), R = y(z, 2), l = R[0], B = R[1], F = b(function() {
    return D(1);
  }, { value: T }), x = y(F, 2), d = x[0], G = x[1], H = M.useMemo(function() {
    var t = [l, d][r];
    return v ? t : C(e, t, q[r]);
  }, [v, l, d, r, e, q]), w = function(t) {
    var o = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "panel";
    (0, [B, G][r])(t);
    var u = [l, d];
    u[r] = t, !A || P(e, g, l, u[0], a) && P(e, g, d, u[1], a) || A(u, { source: o, range: r === 1 ? "end" : "start", mode: i });
  }, Y = M.useRef(null);
  return j(function() {
    if (s && !m[r]) {
      var t = v ? null : e.getNow();
      if (Y.current !== null && Y.current !== r ? t = [l, d][1 ^ r] : n[r] ? t = r === 0 ? n[0] : function(u, c) {
        if (p) {
          var E = { date: "month", week: "month", month: "year", quarter: "year" }[a];
          if (E && !P(e, g, u, c, E) || a === "year" && u && Math.floor(e.getYear(u) / 10) !== Math.floor(e.getYear(c) / 10)) return h(e, a, c, -1);
        }
        return c;
      }(n[0], n[1]) : n[1 ^ r] && (t = n[1 ^ r]), t) {
        k && e.isAfter(k, t) && (t = k);
        var o = p ? h(e, a, t, 1) : t;
        f && e.isAfter(o, f) && (t = p ? h(e, a, f, -1) : f), w(t, "reset");
      }
    }
  }, [s, r, n[r]]), M.useEffect(function() {
    Y.current = s ? r : null;
  }, [s, r]), j(function() {
    s && m && m[r] && w(m[r], "reset");
  }, [s, r]), [H, w];
}
export {
  W as default,
  h as offsetPanelDate
};

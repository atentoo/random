import ae from "../../../../@babel/runtime/helpers/esm/extends.js";
import v from "../../../../@babel/runtime/helpers/esm/objectSpread2.js";
import me from "../../../../@babel/runtime/helpers/esm/slicedToArray.js";
import se from "../../../../../_virtual/index.js";
import le from "../../../../rc-motion/es/CSSMotion.js";
import "../../../../rc-motion/es/CSSMotionList.js";
import * as t from "react";
import pe from "../../../../rc-resize-observer/es/index.js";
import ce from "../../../../rc-util/es/hooks/useLayoutEffect.js";
import { composeRef as de } from "../../../../rc-util/es/ref.js";
import ue from "./Arrow.js";
import he from "./Mask.js";
import ve from "./PopupContent.js";
var ge = t.forwardRef(function(e, z) {
  var g = e.popup, I = e.className, p = e.prefixCls, M = e.style, E = e.target, L = e.onVisibleChanged, r = e.open, V = e.keepDom, A = e.fresh, H = e.onClick, W = e.mask, y = e.arrow, x = e.arrowPos, c = e.align, d = e.motion, O = e.maskMotion, P = e.forceRender, a = e.getPopupContainer, S = e.autoDestroy, _ = e.portal, f = e.zIndex, B = e.onMouseEnter, X = e.onMouseLeave, Y = e.onPointerEnter, j = e.onPointerDownCapture, q = e.ready, F = e.offsetX, G = e.offsetY, J = e.offsetR, K = e.offsetB, Q = e.onAlign, N = e.onPrepare, m = e.stretch, u = e.targetWidth, h = e.targetHeight, T = typeof g == "function" ? g() : g, U = r || V, C = (a == null ? void 0 : a.length) > 0, Z = t.useState(!a || !C), k = me(Z, 2), b = k[0], $ = k[1];
  if (ce(function() {
    !b && C && E && $(!0);
  }, [b, C, E]), !b) return null;
  var n = "auto", o = { left: "-1000vw", top: "-1000vh", right: n, bottom: n };
  if (q || !r) {
    var w, D = c.points, R = c.dynamicInset || ((w = c._experimental) === null || w === void 0 ? void 0 : w.dynamicInset), ee = R && D[0][1] === "r", oe = R && D[0][0] === "b";
    ee ? (o.right = J, o.left = n) : (o.left = F, o.right = n), oe ? (o.bottom = K, o.top = n) : (o.top = G, o.bottom = n);
  }
  var i = {};
  return m && (m.includes("height") && h ? i.height = h : m.includes("minHeight") && h && (i.minHeight = h), m.includes("width") && u ? i.width = u : m.includes("minWidth") && u && (i.minWidth = u)), r || (i.pointerEvents = "none"), t.createElement(_, { open: P || U, getContainer: a && function() {
    return a(E);
  }, autoDestroy: S }, t.createElement(he, { prefixCls: p, open: r, zIndex: f, mask: W, motion: O }), t.createElement(pe, { onResize: Q, disabled: !r }, function(te) {
    return t.createElement(le, ae({ motionAppear: !0, motionEnter: !0, motionLeave: !0, removeOnLeave: !1, forceRender: P, leavedClassName: "".concat(p, "-hidden") }, d, { onAppearPrepare: N, onEnterPrepare: N, visible: r, onVisibleChanged: function(s) {
      var l;
      d == null || (l = d.onVisibleChanged) === null || l === void 0 || l.call(d, s), L(s);
    } }), function(s, l) {
      var re = s.className, ne = s.style, ie = se(p, re, I);
      return t.createElement("div", { ref: de(te, z, l), className: ie, style: v(v(v(v({ "--arrow-x": "".concat(x.x || 0, "px"), "--arrow-y": "".concat(x.y || 0, "px") }, o), i), ne), {}, { boxSizing: "border-box", zIndex: f }, M), onMouseEnter: B, onMouseLeave: X, onPointerEnter: Y, onClick: H, onPointerDownCapture: j }, y && t.createElement(ue, { prefixCls: p, arrow: y, arrowPos: x, align: c }), t.createElement(ve, { cache: !r && !A }, T));
    });
  }));
});
process.env.NODE_ENV !== "production" && (ge.displayName = "Popup");
export {
  ge as default
};

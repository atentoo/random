"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const B=require("../../@babel/runtime/helpers/esm/extends.cjs"),Se=require("../../@babel/runtime/helpers/esm/objectDestructuringEmpty.cjs"),y=require("../../@babel/runtime/helpers/esm/slicedToArray.cjs"),Ce=require("../../@babel/runtime/helpers/esm/objectWithoutProperties.cjs"),Me=require("../../rc-util/es/hooks/useLayoutEffect.cjs"),Oe=require("../../rc-virtual-list/es/List.cjs"),Re=require("react"),qe=require("./MotionTreeNode.cjs"),S=require("./utils/diffUtil.cjs"),C=require("./utils/treeUtil.cjs");function Ie(e){const d=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const a in e)if(a!=="default"){const i=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(d,a,i.get?i:{enumerable:!0,get:()=>e[a]})}}return d.default=e,Object.freeze(d)}const n=Ie(Re);var Te=["prefixCls","data","selectable","checkable","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","keyEntities","disabled","dragging","dragOverNodeKey","dropPosition","motion","height","itemHeight","virtual","scrollWidth","focusable","activeItem","focused","tabIndex","onKeyDown","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd"],A={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},we=function(){},o="RC_TREE_MOTION_".concat(Math.random()),M={key:o},G={key:o,level:0,index:0,pos:"0",node:M,nodes:[M]},V={parent:null,children:[],pos:G.pos,data:M,title:null,key:o,isStart:[],isEnd:[]};function O(e,d,a,i){return d!==!1&&a?e.slice(0,Math.ceil(a/i)+1):e}function z(e){var d=e.key,a=e.pos;return C.getKey(d,a)}var Y=n.forwardRef(function(e,d){var a=e.prefixCls,i=e.data;e.selectable,e.checkable;var s=e.expandedKeys,J=e.selectedKeys,Q=e.checkedKeys,U=e.loadedKeys,X=e.loadingKeys,Z=e.halfCheckedKeys,$=e.keyEntities,ee=e.disabled,R=e.dragging,te=e.dragOverNodeKey,ne=e.dropPosition,q=e.motion,m=e.height,E=e.itemHeight,K=e.virtual,ie=e.scrollWidth,I=e.focusable,g=e.activeItem,ae=e.focused,re=e.tabIndex,le=e.onKeyDown,de=e.onFocus,oe=e.onBlur,se=e.onActiveChange,ce=e.onListChangeStart,ue=e.onListChangeEnd,fe=Ce(e,Te),T=n.useRef(null),w=n.useRef(null);n.useImperativeHandle(d,function(){return{scrollTo:function(t){T.current.scrollTo(t)},getIndentWidth:function(){return w.current.offsetWidth}}});var ye=n.useState(s),P=y(ye,2),ge=P[0],he=P[1],pe=n.useState(i),_=y(pe,2),c=_[0],j=_[1],ve=n.useState(i),D=y(ve,2),me=D[0],h=D[1],Ee=n.useState([]),H=y(Ee,2),Ke=H[0],b=H[1],be=n.useState(null),L=y(be,2),ke=L[0],k=L[1],W=n.useRef(i);function x(){var t=W.current;j(t),h(t),b([]),k(null),ue()}W.current=i,Me.default(function(){he(s);var t=S.findExpandedKeys(ge,s);if(t.key!==null)if(t.add){var r=c.findIndex(function(f){return f.key===t.key}),l=O(S.getExpandRange(c,i,t.key),K,m,E),p=c.slice();p.splice(r+1,0,V),h(p),b(l),k("show")}else{var u=i.findIndex(function(f){return f.key===t.key}),N=O(S.getExpandRange(i,c,t.key),K,m,E),v=i.slice();v.splice(u+1,0,V),h(v),b(N),k("hide")}else c!==i&&(j(i),h(i))},[s,i]),n.useEffect(function(){R||x()},[R]);var xe=q?me:i,F={expandedKeys:s,selectedKeys:J,loadedKeys:U,loadingKeys:X,checkedKeys:Q,halfCheckedKeys:Z,dragOverNodeKey:te,dropPosition:ne,keyEntities:$};return n.createElement(n.Fragment,null,ae&&g&&n.createElement("span",{style:A,"aria-live":"assertive"},function(t){for(var r=String(t.data.key),l=t;l.parent;)l=l.parent,r="".concat(l.data.key," > ").concat(r);return r}(g)),n.createElement("div",null,n.createElement("input",{style:A,disabled:I===!1||ee,tabIndex:I!==!1?re:null,onKeyDown:le,onFocus:de,onBlur:oe,value:"",onChange:we,"aria-label":"for screen reader"})),n.createElement("div",{className:"".concat(a,"-treenode"),"aria-hidden":!0,style:{position:"absolute",pointerEvents:"none",visibility:"hidden",height:0,overflow:"hidden",border:0,padding:0}},n.createElement("div",{className:"".concat(a,"-indent")},n.createElement("div",{ref:w,className:"".concat(a,"-indent-unit")}))),n.createElement(Oe.default,B({},fe,{data:xe,itemKey:z,height:m,fullHeight:!1,virtual:K,itemHeight:E,scrollWidth:ie,prefixCls:"".concat(a,"-list"),ref:T,role:"tree",onVisibleChange:function(t){t.every(function(r){return z(r)!==o})&&x()}}),function(t){var r=t.pos,l=Object.assign({},(Se(t.data),t.data)),p=t.title,u=t.key,N=t.isStart,v=t.isEnd,f=C.getKey(u,r);delete l.key,delete l.children;var Ne=C.getTreeNodeProps(f,F);return n.createElement(qe,B({},l,Ne,{title:p,active:!!g&&u===g.key,pos:r,data:t.data,isStart:N,isEnd:v,motion:q,motionNodes:u===o?Ke:null,motionType:ke,onMotionStart:ce,onMotionEnd:x,treeNodeRequiredProps:F,onMouseMove:function(){se(null)}}))}))});process.env.NODE_ENV!=="production"&&(Y.displayName="NodeList"),exports.MOTION_KEY=o,exports.MotionEntity=G,exports.default=Y,exports.getMinimumRangeTransitionRange=O;

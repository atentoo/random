import l from "../../../rc-util/es/KeyCode.js";
import w from "../../../rc-util/es/raf.js";
import * as a from "react";
var m = l.ESC, y = l.TAB;
function h(r) {
  var o = r.visible, d = r.triggerRef, t = r.onVisibleChange, v = r.autoFocus, c = r.overlayRef, u = a.useRef(!1), i = function() {
    var e, n;
    o && ((e = d.current) === null || e === void 0 || (n = e.focus) === null || n === void 0 || n.call(e), t == null || t(!1));
  }, f = function() {
    var e;
    return !((e = c.current) === null || e === void 0 || !e.focus) && (c.current.focus(), u.current = !0, !0);
  }, s = function(e) {
    switch (e.keyCode) {
      case m:
        i();
        break;
      case y:
        var n = !1;
        u.current || (n = f()), n ? e.preventDefault() : i();
    }
  };
  a.useEffect(function() {
    return o ? (window.addEventListener("keydown", s), v && w(f, 3), function() {
      window.removeEventListener("keydown", s), u.current = !1;
    }) : function() {
      u.current = !1;
    };
  }, [o]);
}
export {
  h as default
};

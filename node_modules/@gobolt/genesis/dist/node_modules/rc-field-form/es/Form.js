import G from "../../@babel/runtime/helpers/esm/extends.js";
import s from "../../@babel/runtime/helpers/esm/objectSpread2.js";
import J from "../../@babel/runtime/helpers/esm/slicedToArray.js";
import L from "../../@babel/runtime/helpers/esm/objectWithoutProperties.js";
import * as n from "react";
import N from "./useForm.js";
import U, { HOOK_MARK as W } from "./FieldContext.js";
import _ from "./FormContext.js";
import { isSimilar as Q } from "./utils/valueUtil.js";
import X from "./ListContext.js";
var Y = ["name", "initialValues", "fields", "form", "preserve", "children", "component", "validateMessages", "validateTrigger", "onValuesChange", "onFieldsChange", "onFinish", "onFinishFailed", "clearOnDestroy"], se = function(e, D) {
  var l = e.name, O = e.initialValues, u = e.fields, P = e.form, H = e.preserve, m = e.children, p = e.component, F = p === void 0 ? "form" : p, I = e.validateMessages, c = e.validateTrigger, h = c === void 0 ? "onChange" : c, S = e.onValuesChange, C = e.onFieldsChange, V = e.onFinish, T = e.onFinishFailed, k = e.clearOnDestroy, g = L(e, Y), E = n.useRef(null), o = n.useContext(_), x = N(P), r = J(x, 1)[0], a = r.getInternalHooks(W), A = a.useSubscribe, K = a.setInitialValues, w = a.setCallbacks, j = a.setValidateMessages, q = a.setPreserve, z = a.destroyForm;
  n.useImperativeHandle(D, function() {
    return s(s({}, r), {}, { nativeElement: E.current });
  }), n.useEffect(function() {
    return o.registerForm(l, r), function() {
      o.unregisterForm(l);
    };
  }, [o, r, l]), j(s(s({}, o.validateMessages), I)), w({ onValuesChange: S, onFieldsChange: function(t) {
    if (o.triggerFormChange(l, t), C) {
      for (var i = arguments.length, b = new Array(i > 1 ? i - 1 : 0), f = 1; f < i; f++) b[f - 1] = arguments[f];
      C.apply(void 0, [t].concat(b));
    }
  }, onFinish: function(t) {
    o.triggerFormFinish(l, t), V && V(t);
  }, onFinishFailed: T }), q(H);
  var v, d = n.useRef(null);
  K(O, !d.current), d.current || (d.current = !0), n.useEffect(function() {
    return function() {
      return z(k);
    };
  }, []);
  var y = typeof m == "function";
  y ? v = m(r.getFieldsValue(!0), r) : v = m, A(!y);
  var M = n.useRef();
  n.useEffect(function() {
    Q(M.current || [], u || []) || r.setFields(u || []), M.current = u;
  }, [u, r]);
  var B = n.useMemo(function() {
    return s(s({}, r), {}, { validateTrigger: h });
  }, [r, h]), R = n.createElement(X.Provider, { value: null }, n.createElement(U.Provider, { value: B }, v));
  return F === !1 ? R : n.createElement(F, G({}, g, { ref: E, onSubmit: function(t) {
    t.preventDefault(), t.stopPropagation(), r.submit();
  }, onReset: function(t) {
    var i;
    t.preventDefault(), r.resetFields(), (i = g.onReset) === null || i === void 0 || i.call(g, t);
  } }), R);
};
export {
  se as default
};
